---
phase: 16-type-safety-complete
task: 5
total_tasks: 5
status: complete
last_updated: 2026-02-24T15:18:49.741Z
---

<current_state>
Phase 16 (Cross-cutting Type Safety) COMPLETE. All 5/5 tasks done and committed.
Branch `016-code-expressiveness` pushed to remote at commit e402ad7.
Code review passed — no blockers, 2 minor accepted items (trust boundary consistency).
60/86 total tasks done (70%).
</current_state>

<completed_work>
Phase 16 (T058, T059, T060, T085, T086) — committed as e402ad7:

- T058: Created src/app.d.ts with typed globalThis declarations for \__argos_\* singletons. Removed unsafe `as Record<string, unknown>` casts from 5 consumer files.
- T059: Added JSON.parse() runtime validation guards at WebSocket trust boundaries (websocket-server.ts, web-socket-manager.ts).
- T060: Fixed 3 swallowed errors in OverviewPanel.svelte — console.error() instead of /_ silent _/.
- T085: Typed external API interfaces — OpenCellIDCell, GpsdSatelliteEntry (Zod-derived), OpenMeteoCurrentWeather. Eliminated unsafe as-casts.
- T086: Resolved 3 eslint-disable directives — symbol-factory.ts fixed (MilStdRenderer type), validation-error.ts fixed (ZodIssue narrowing), data-stream retained with accurate comment.

Prior phases (1-15) all complete — 55 tasks.
</completed_work>

<remaining_work>

- Phase 18 (Route Migration at Scale, 10 tasks): T068-T077 — migrate ~60 routes to createHandler() factory in 10 batches of 5 files each
- Phase 8b-f (Client Libraries, 9 tasks): T018-T024, T078-T079 — needs npm install approval for @tanstack/table-core, virtua, sveltekit-superforms+formsnap, @tanstack/svelte-query
- Phase 17 (Final Verification, 7 tasks): T061-T067 — depends on all other phases

Total remaining: 26 tasks across 3 phases
</remaining_work>

<decisions_made>

- Code review accepted 2 minor items: fetchTile() and fetchWeather() trust res.json() with as-cast rather than runtime validation. Accepted because downstream code uses fallbacks (|| and ?? operators) that handle undefined gracefully.
- T086: Kept data-stream/+server.ts eslint-disable — Node.js EventEmitter.off() requires any[] due to contravariance. Updated comment to explain why.
- T085: Dropped KismetRawDevice from task scope — kismet/devices/+server.ts already uses Record<string, unknown> with helper functions that degrade gracefully. Not worth adding another interface layer.
  </decisions_made>

<blockers>
None.
</blockers>

<context>
Phase 18 (Route Migration) is the largest remaining phase — 10 batches of 5 route files each, all migrating to createHandler() factory. Each batch is independent (different API domains). Good candidate for parallel agent execution (max 2 agents per user constraint).

Phase 8b-f requires user approval for 4 npm packages before starting.

Phase 17 is final verification — depends on everything else.
</context>

<next_action>
/clear then /gsd:execute-phase 18 — start Route Migration at Scale.
Or ask user about npm package approvals for Phase 8b-f first.
</next_action>
