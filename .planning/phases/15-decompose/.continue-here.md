---
phase: 15-decompose
task: 9
total_tasks: 13
status: in_progress
last_updated: 2026-02-24T14:11:03.380Z
---

<current_state>
Phase 15 (US12 — Oversized File Decomposition) of spec-016 code-expressiveness.
Branch: `016-code-expressiveness`. 50/86 total tasks done (58%).
8 of 13 Phase 15 decomposition tasks complete (T045-T052). 5 remaining.
All work committed and pushed to remote. Build passes. No uncommitted changes.
</current_state>

<completed_work>

- T045: `websocket/base.ts` (394→281) — extract websocket-types, websocket-heartbeat, websocket-reconnect
- T046: `gsm-evil-store.ts` (380→232) — extract gsm-evil-types, gsm-evil-persistence
- T047: `gsm-evil-health-service.ts` (370→138) — extract gsm-evil-health-checks
- T048: `terminal-store.ts` (347→290) — extract terminal-session-helpers
- T049: `dashboard-map-logic.svelte.ts` (335→265) — extract map-gps-derived.svelte.ts
- T050: `TakConfigView.svelte` (329→219) — extract TakServerForm, TakAuthMethodPicker
- T051: `error-tracker.ts` (321→223) — extract error-recovery.ts (RecoveryManager)
- T052: `gsm-scan-frequency-analysis.ts` (316→264) — extract gsm-grgsm-process.ts
  </completed_work>

<remaining_work>

- T053: `gsm-scan-capture.ts` (313 LOC) — split capture management / processing
- T054: `sweep-manager.ts` (313 LOC) — split sweep coordination / configuration
- T055: `tak-service.ts` (312 LOC) — split connection management / TAK operations
- T056: `kismet-control-service-extended.ts` (308 LOC) — split control commands / status checking
- T057: `DashboardMap.svelte` (300 LOC) — evaluate borderline case, extract map-controls only if clean split

After Phase 15, remaining phases:

- Phase 8 (US8 client libs, 9 tasks) — needs user approval for npm installs
- Phase 16 (type safety, 5 tasks)
- Phase 18 (route migration at scale, 10 tasks)
- Phase 17 (final verification, 7 tasks)
  </remaining_work>

<decisions_made>

- Svelte rune-aware splitting: `.svelte.ts` modules can use $state/$derived, extracted pure functions via parameters
- Used $bindable() props for extracted Svelte sub-components to preserve bind:config contract
- Composition over inheritance for ErrorTracker → RecoveryManager (composed helper, not subclass)
- LOC counts in commit messages may differ slightly from final due to prettier reformatting in pre-commit hook
- gsm-evil-store.ts had unused `schedulePersist` import after extraction — fixed before commit
  </decisions_made>

<blockers>
- None. All 8 tasks committed cleanly with passing build.
</blockers>

<context>
Decomposition pattern: read file → identify natural responsibility boundaries → extract cohesive chunk into new module → rewrite imports in original → verify build → commit batch.
Each file is unique so read it first before deciding the split. Files over 300 LOC are the target; the 300 LOC limit comes from CLAUDE.md Article II.2.
T057 (DashboardMap.svelte at exactly 300 LOC) is borderline — task says evaluate and only extract if clean split exists.
</context>

<next_action>
Start with: Read `src/lib/server/services/gsm-evil/gsm-scan-capture.ts` (T053, 313 LOC) and identify the split point. Pattern: extract capture processing helpers into a companion module. Then proceed through T054-T057 sequentially, committing in batches.
</next_action>
