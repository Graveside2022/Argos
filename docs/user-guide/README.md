# Stinkster User Guide

Welcome to the Stinkster platform - a comprehensive tactical networking and spectrum analysis system built on Raspberry Pi. This guide will help you get started and make the most of all system features.

## Table of Contents

1. [Getting Started](#getting-started)
2. [System Overview](#system-overview)
3. [Web Interfaces](#web-interfaces)
4. [Common Operations](#common-operations)
5. [Troubleshooting](#troubleshooting)
6. [Safety & Legal](#safety--legal)

## Getting Started

### Quick Start

To start all Stinkster services:

```bash
cd /home/pi/projects/stinkster_christian/stinkster
./src/orchestration/gps_kismet_wigle.sh
```

This single command starts:
- GPS services (if GPS hardware is connected)
- Kismet WiFi scanning
- WigleToTAK converter
- All web interfaces

### Checking System Status

To verify all services are running:

```bash
./dev/tools/health-check.sh
```

### Stopping Services

To stop all services cleanly:
```bash
# Press Ctrl+C in the terminal running the orchestration script
# Or from another terminal:
pkill -f "gps_kismet_wigle.sh"
```

## System Overview

Stinkster combines four main capabilities:

1. **SDR Operations** - Software Defined Radio with HackRF
2. **WiFi Scanning** - Network discovery and monitoring
3. **GPS Tracking** - Location services and mapping
4. **TAK Integration** - Tactical Awareness Kit compatibility

### Hardware Components

- **Raspberry Pi**: Main processing unit (Pi 4 recommended)
- **HackRF One**: SDR device for spectrum analysis
- **WiFi Adapter**: Monitor-mode capable adapter (e.g., Alfa AWUS036ACH)
- **GPS Receiver**: Optional for location services (USB or serial)

## Web Interfaces

### 1. OpenWebRX - SDR Receiver
**URL**: `http://your-pi:8073`  
**Login**: admin / hackrf

Features:
- Live spectrum waterfall display
- Multiple demodulation modes (FM, AM, SSB, etc.)
- Frequency bookmarks
- Recording capabilities

**Common Operations**:
- Click on waterfall to tune to frequency
- Scroll to zoom in/out
- Select demodulation mode from dropdown
- Adjust squelch to reduce noise

### 2. Spectrum Analyzer
**URL**: `http://your-pi:8092`

Features:
- Real-time FFT display
- Frequency range selection
- Gain controls
- Signal strength indicators

**Controls**:
- **Frequency**: Enter center frequency in MHz
- **Sample Rate**: Select bandwidth to monitor
- **Gain**: Adjust LNA, VGA, and AMP settings
- **Start/Stop**: Control data acquisition

### 3. WigleToTAK Dashboard
**URL**: `http://your-pi:6969`

Features:
- WiFi device tracking
- TAK message generation
- Real-time device list
- GPS status display

**Key Functions**:
- View discovered WiFi devices
- Monitor signal strength
- Export to TAK format
- Configure TAK server settings

### 4. Kismet Interface
**URL**: `http://your-pi:2501`

Features:
- Professional WiFi monitoring
- Device fingerprinting
- Channel hopping control
- Packet capture

## Common Operations

### Starting Individual Services

#### GPS Only
```bash
sudo systemctl start gpsd
gpspipe -w -n 1  # Test GPS output
```

#### Kismet Only
```bash
/home/pi/Scripts/start_kismet.sh
```

#### WigleToTAK Only
```bash
cd /home/pi/WigletoTAK/WigleToTAK/TheStinkToTAK
source venv/bin/activate
python3 WigleToTak2.py
```

### Monitoring Operations

#### View Logs
```bash
# Main orchestration log
tail -f /home/pi/tmp/gps_kismet_wigle.log

# Kismet log
tail -f /home/pi/tmp/kismet.log

# WigleToTAK log
tail -f /home/pi/tmp/wigletotak.log
```

#### Check Process Status
```bash
# See what's running
ps aux | grep -E "(kismet|wigle|gpsd|hackrf)"

# Check service PIDs
cat /home/pi/tmp/gps_kismet_wigle.pids
```

### Data Management

#### WiFi Scan Data
- Location: `/home/pi/kismet_ops/*.wiglecsv`
- Format: CSV files with device information
- Auto-generated by Kismet

#### Configuration Files
- HackRF: `/home/pi/HackRF/config.json`
- OpenWebRX: Docker volumes
- Kismet: `/etc/kismet/kismet_site.conf`

### Network Configuration

#### Set WiFi Adapter to Monitor Mode
```bash
# For interface wlan2
sudo ip link set wlan2 down
sudo iw dev wlan2 set monitor none
sudo ip link set wlan2 up
```

#### Return to Managed Mode
```bash
sudo ip link set wlan2 down
sudo iw dev wlan2 set type managed
sudo ip link set wlan2 up
```

## Troubleshooting

### Service Won't Start

1. **Check logs**:
   ```bash
   tail -n 50 /home/pi/tmp/gps_kismet_wigle.log
   ```

2. **Verify hardware**:
   ```bash
   lsusb  # Check USB devices
   ls -l /dev/ttyUSB* /dev/ttyACM*  # Check serial devices
   ```

3. **Test individual components**:
   ```bash
   /home/pi/test-hackrf.sh  # Test HackRF
   gpspipe -w -n 1  # Test GPS
   ```

### HackRF Issues

**Not detected**:
```bash
# Check USB connection
lsusb | grep HackRF

# Test with hackrf_info
hackrf_info
```

**OpenWebRX not working**:
```bash
# Restart Docker container
docker restart openwebrx

# Check logs
docker logs openwebrx --tail 50
```

### WiFi Adapter Issues

**Not entering monitor mode**:
```bash
# Check capabilities
iw list | grep -A 10 "monitor"

# Try alternative method
sudo airmon-ng start wlan2
```

### GPS Issues

**No GPS fix**:
```bash
# Check GPS daemon
sudo systemctl status gpsd

# Test GPS directly
sudo stty -F /dev/ttyUSB0 4800
cat /dev/ttyUSB0
```

### Performance Issues

**System running slow**:
```bash
# Check CPU usage
htop

# Check temperature
vcgencmd measure_temp

# Free up memory
sudo sync && sudo sysctl -w vm.drop_caches=3
```

## Safety & Legal

### RF Safety
- Keep antennas away from eyes and body
- Use appropriate antennas for frequency ranges
- Don't transmit without proper licensing
- Monitor local RF exposure limits

### Legal Compliance
- Check local laws regarding:
  - WiFi scanning and monitoring
  - RF spectrum monitoring
  - GPS tracking
  - Network analysis

### Best Practices
- Only monitor networks you own or have permission to monitor
- Respect privacy of discovered devices
- Don't interfere with licensed services
- Keep software updated for security patches

## Advanced Features

### Custom Frequency Scanning

Create custom scan profiles:
```bash
# Edit HackRF config
nano /home/pi/HackRF/config.json
```

### TAK Server Integration

Configure TAK output:
1. Open WigleToTAK dashboard
2. Click Settings
3. Enter TAK server details
4. Test connection

### Automated Monitoring

Set up scheduled scans:
```bash
# Add to crontab
crontab -e

# Add line for hourly scan
0 * * * * /home/pi/stinky/gps_kismet_wigle.sh >> /home/pi/logs/scan.log 2>&1
```

## Support

### Getting Help

1. Check logs first - they often contain helpful error messages
2. Verify hardware connections
3. Try individual components separately
4. Consult the [Troubleshooting Guide](../deployment/TROUBLESHOOTING.md)

### Common Error Messages

| Error | Cause | Solution |
|-------|-------|----------|
| "No GPS fix" | GPS not connected or no signal | Check connections, move outdoors |
| "HackRF not found" | USB issue or driver problem | Reconnect USB, check `lsusb` |
| "Monitor mode failed" | Incompatible adapter | Use compatible adapter |
| "Port already in use" | Service already running | Stop duplicate service |

## Next Steps

- Explore the [Developer Guide](../developer-guide/README.md) to customize Stinkster
- Read the [API Documentation](../api-reference/README.md) for integration options
- Check [Video Tutorials](../tutorials/README.md) for visual guides

Remember: With great power comes great responsibility. Use Stinkster ethically and legally!