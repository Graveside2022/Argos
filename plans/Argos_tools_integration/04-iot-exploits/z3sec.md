# Z3sec

> **RISK CLASSIFICATION**: MODERATE RISK
> ZigBee network security assessment tool capable of touchlink commissioning attacks and key sniffing, but limited to analysis and specific protocol-level tests. Military education/training toolkit - Not for public release.

> **NOTE**: Z3sec installs via `pip install .` which registers CLI tools (`z3sec_touchlink`, `z3sec_control`, etc.) as console scripts. Requires KillerBee as a prerequisite for hardware communication.

## Deployment Classification

> **RUNS ON ARGOS RPi 5: YES** â€” pure Python; inherits ARM64 compatibility from KillerBee

| Method               | Supported | Notes                                                              |
| -------------------- | --------- | ------------------------------------------------------------------ |
| **Docker Container** | YES       | USB passthrough for 802.15.4 radio hardware; --privileged required |
| **Native Install**   | YES       | pip install; requires KillerBee as prerequisite                    |

---

## Tool Description

Z3sec is a ZigBee security testing framework developed by IoTsec for evaluating ZigBee network security posture. It focuses on ZigBee 3.0 security mechanisms including touchlink commissioning vulnerabilities, network key transport analysis, and trust center behavior assessment. The tool can perform touchlink factory reset attacks, identify improperly secured key exchanges, scan for ZigBee networks, and analyze the security configuration of discovered devices. It operates on top of the KillerBee framework for hardware abstraction.

## Category

ZigBee 3.0 Security Assessment / Protocol Analysis

## Repository

https://github.com/IoTsec/Z3sec

---

## Docker Compatibility Analysis

### Can it run in Docker?

**YES** - Z3sec is Python-based and runs in Docker with USB passthrough for ZigBee radio hardware. Depends on KillerBee for hardware communication. No GUI requirements.

### Host OS-Level Requirements

- `--device=/dev/bus/usb` - USB passthrough for 802.15.4 radio hardware (RZUSBstick, CC2531, or ApiMote)
- `--privileged` - Required for raw USB device access
- Compatible hardware must be flashed with appropriate firmware before use (same requirements as KillerBee)
- No special kernel modules beyond standard USB drivers

### Docker-to-Host Communication

- No network port mappings required (radio communication via USB hardware)
- Volume mount for scan results and logs: `-v /host/output:/app/output`
- Output data is typically text/JSON format, compatible with Argos data pipeline ingestion

---

## Install Instructions (Docker on Kali RPi 5)

### Dockerfile

```dockerfile
FROM python:3.11-slim

RUN apt-get update && apt-get install -y \
    git \
    build-essential \
    libusb-1.0-0-dev \
    libusb-dev \
    python3-dev \
    usbutils \
    pkg-config \
    && rm -rf /var/lib/apt/lists/*

# Install KillerBee (required dependency)
RUN git clone https://github.com/riverloopsec/killerbee.git /opt/killerbee && \
    cd /opt/killerbee && \
    pip install --no-cache-dir pyusb pyserial cryptography && \
    pip install --no-cache-dir .

# Install Z3sec (installs console scripts: z3sec_touchlink, z3sec_control, etc.)
RUN git clone https://github.com/IoTsec/Z3sec.git /opt/z3sec && \
    cd /opt/z3sec && \
    pip install --no-cache-dir .

VOLUME ["/output"]
WORKDIR /output

ENTRYPOINT ["/bin/bash"]
```

```bash
# Build
docker build -t argos/z3sec .

# Run - interactive shell with all Z3sec tools available
docker run --rm -it --privileged \
  --device=/dev/bus/usb \
  -v $(pwd)/z3sec-output:/output \
  argos/z3sec

# Available console scripts (installed via setup.py):
#   z3sec_touchlink      - Touchlink commissioning vulnerability tests
#   z3sec_control        - Device control via touchlink
#   z3sec_key_extract    - Network key extraction
#   z3sec_show           - Display ZigBee network information
#   z3sec_install_code   - Install code operations

# Example: run touchlink scan
docker run --rm -it --privileged \
  --device=/dev/bus/usb \
  -v $(pwd)/z3sec-output:/output \
  argos/z3sec -c "z3sec_touchlink --help"

# Example: run key extraction
docker run --rm -it --privileged \
  --device=/dev/bus/usb \
  -v $(pwd)/z3sec-output:/output \
  argos/z3sec -c "z3sec_key_extract --help"
```

---

## Kali Linux Raspberry Pi 5 Compatibility

### Architecture Support

**ARM64 COMPATIBLE** - Z3sec is pure Python and inherits ARM64 compatibility from KillerBee. No architecture-specific code or compiled extensions. All dependencies resolve cleanly on aarch64.

### Hardware Constraints

- CPU: Lightweight - ZigBee channel scanning and packet analysis require minimal CPU. Single Cortex-A76 core is more than sufficient
- RAM: Minimal usage (~50-100MB including KillerBee). No concern with 8GB available
- **Hardware Requirement**: Requires KillerBee-compatible 802.15.4 radio hardware:
    - Atmel RZUSBstick (with KillerBee firmware)
    - TI CC2531 (with sniffer firmware)
    - ApiMote v4b
- Z3sec depends on KillerBee; install KillerBee first

### Verdict

**COMPATIBLE** - Z3sec runs on Raspberry Pi 5 without issues. It provides ZigBee 3.0-specific security tests that complement the broader KillerBee framework. Install KillerBee as a prerequisite. The touchlink commissioning attack module is particularly relevant for smart home security assessments. Hardware availability (RZUSBstick or CC2531) is the primary deployment constraint.
