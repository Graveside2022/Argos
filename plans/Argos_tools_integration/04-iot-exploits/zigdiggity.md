# ZigDiggity

> **RISK CLASSIFICATION**: HIGH RISK - SENSITIVE SOFTWARE
> Capable of active ZigBee network attacks including key extraction, replay attacks, and smart home device exploitation. Military education/training toolkit - Not for public release.

## Deployment Classification

> **RUNS ON ARGOS RPi 5: YES** â€” pure Python with KillerBee dependency; requires 802.15.4 USB radio hardware

| Method               | Supported | Notes                                                                  |
| -------------------- | --------- | ---------------------------------------------------------------------- |
| **Docker Container** | YES       | USB passthrough for RZUSBstick/CC2531; --privileged for raw USB access |
| **Native Install**   | YES       | pip install; KillerBee and all deps support ARM64                      |

---

## Tool Description

ZigDiggity is a ZigBee penetration testing framework developed by Bishop Fox. It automates ZigBee network assessment tasks including network discovery, packet sniffing, key extraction from insecure key transport, replay attacks, and exploitation of smart home devices (locks, lights, thermostats). The framework uses the Atmel RZUSBstick hardware for direct 802.15.4 radio communication and provides scripted attack workflows for common ZigBee security assessment scenarios.

## Category

ZigBee Network Exploitation / Smart Home Attack Framework

## Repository

https://github.com/BishopFox/zigdiggity

---

## Docker Compatibility Analysis

### Can it run in Docker?

**YES** - ZigDiggity runs in Docker with USB passthrough for the RZUSBstick hardware. It is a Python-based tool with no GUI requirements. All operations are CLI-driven.

### Host OS-Level Requirements

- `--device=/dev/bus/usb` - USB passthrough for Atmel RZUSBstick (or compatible 802.15.4 adapter)
- `--privileged` - Required for raw USB device access and direct radio communication
- Host must have the RZUSBstick firmware flashed with KillerBee-compatible firmware (not factory default)
- No special kernel modules required; standard USB drivers suffice

### Docker-to-Host Communication

- No network port mappings required (all communication is over 802.15.4 radio via USB hardware)
- Volume mount for captured packets and logs: `-v /host/output:/app/output`
- Captured PCAP files can be shared with Wireshark on the host via volume mount

---

## Install Instructions (Docker on Kali RPi 5)

### Dockerfile

```dockerfile
FROM python:3.11-slim

RUN apt-get update && apt-get install -y \
    git \
    build-essential \
    libusb-1.0-0-dev \
    libusb-dev \
    python3-dev \
    usbutils \
    pkg-config \
    && rm -rf /var/lib/apt/lists/*

# Install KillerBee (dependency for RZUSBstick communication)
RUN pip install --no-cache-dir pyusb pyserial

RUN git clone https://github.com/riverloopsec/killerbee.git /opt/killerbee && \
    cd /opt/killerbee && \
    pip install --no-cache-dir .

# Install ZigDiggity
RUN git clone https://github.com/BishopFox/zigdiggity.git /app

WORKDIR /app
RUN pip install --no-cache-dir -r requirements.txt 2>/dev/null || \
    pip install --no-cache-dir scapy cryptography

VOLUME ["/app/output"]

ENTRYPOINT ["python3"]
CMD ["--help"]
```

```bash
# Build
docker build -t argos/zigdiggity .

# Run - list available attack scripts
docker run --rm \
  argos/zigdiggity -c "import os; [print(f) for f in os.listdir('/app') if f.endswith('.py')]"

# Run - network discovery (scan for ZigBee networks on all channels)
docker run --rm -it --privileged \
  --device=/dev/bus/usb \
  -v $(pwd)/zigbee-output:/app/output \
  argos/zigdiggity scan.py

# Run - sniff ZigBee traffic on a specific channel
docker run --rm -it --privileged \
  --device=/dev/bus/usb \
  -v $(pwd)/zigbee-output:/app/output \
  argos/zigdiggity listen.py --channel 15

# Run - interactive shell for manual operation
docker run --rm -it --privileged \
  --device=/dev/bus/usb \
  -v $(pwd)/zigbee-output:/app/output \
  --entrypoint /bin/bash \
  argos/zigdiggity
```

---

## Kali Linux Raspberry Pi 5 Compatibility

### Architecture Support

**ARM64 COMPATIBLE** - ZigDiggity is pure Python. All dependencies (scapy, cryptography, pyusb) have ARM64 support via pip wheels or source compilation. KillerBee, the underlying library for RZUSBstick communication, also supports ARM64.

### Hardware Constraints

- CPU: Lightweight - ZigBee operates at 250 kbps; packet processing requires minimal CPU. A single Cortex-A76 core handles all operations without strain
- RAM: Minimal usage (~50-100MB). No concern with 8GB available
- **Hardware Requirement (Critical)**: Requires an Atmel RZUSBstick (AT86RF230-based) flashed with KillerBee firmware. This is a specific, increasingly rare USB dongle. Without it, ZigDiggity cannot operate. Alternative: TI CC2531 USB dongle with appropriate firmware, though compatibility may vary
- The RZUSBstick must be re-flashed from factory firmware to KillerBee firmware using `kb_flash_rzusbstick` from the KillerBee toolkit

### Verdict

**COMPATIBLE** - ZigDiggity runs on Raspberry Pi 5 without platform-specific issues. The primary constraint is hardware availability: the Atmel RZUSBstick is discontinued and difficult to source. If the hardware is available, Docker deployment is straightforward. The tool has not been actively maintained since 2019; some attack scripts may need updates for current ZigBee stack versions.
