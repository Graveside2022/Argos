# Braktooth

> **RISK CLASSIFICATION**: HIGH RISK - SENSITIVE SOFTWARE
> Bluetooth Classic vulnerability PoC exploits targeting chipset firmware bugs, capable of causing denial of service, deadlocks, and arbitrary code execution on vulnerable BT devices. Military education/training toolkit - Not for public release.

---

## Deployment Classification

> **RUNS ON ARGOS RPi 5: YES** — Python/C host controller compiles on ARM64; ESP32 firmware is architecture-independent

| Method               | Supported | Notes                                                              |
| -------------------- | --------- | ------------------------------------------------------------------ |
| **Docker Container** | YES       | Privileged mode + USB serial passthrough for ESP32 board           |
| **Native Install**   | YES       | Build with GCC + pip on Kali ARM64; requires ESP32 DevKit hardware |

---

## Tool Description

Braktooth is a collection of proof-of-concept exploits for Bluetooth Classic (BR/EDR) vulnerabilities discovered across major Bluetooth chipset vendors including Intel, Qualcomm, Texas Instruments, Cypress, and Silicon Labs. The toolkit exploits firmware-level bugs in the Bluetooth LMP (Link Manager Protocol) and baseband layers, triggering effects ranging from device crashes and deadlocks to arbitrary code execution. It targets over 16 CVEs including CVE-2021-28139 (arbitrary code execution on ESP32) and various denial-of-service conditions affecting billions of deployed Bluetooth devices.

## Category

BT Classic Firmware Exploitation / Vulnerability PoC

## Repository

https://github.com/Matheus-Garbelini/braktooth_esp32_bluetooth_classic_attacks

---

## Docker Compatibility Analysis

### Can it run in Docker?

**YES** - Braktooth can run in Docker with Bluetooth adapter passthrough. The exploit framework uses a modified ESP32 firmware as the attack radio, communicating over USB serial, and the host-side controller is C/Python-based.

### Host OS-Level Requirements

- `--privileged` - Required for raw Bluetooth HCI access and USB serial communication
- `--device=/dev/ttyUSB0` (or equivalent) - USB serial passthrough for ESP32 attack board
- `--device=/dev/bus/usb` - Broad USB passthrough if multiple devices
- Host kernel modules: `cp210x` or `ch341` for ESP32 USB-UART bridge
- `--net=host` - Not strictly required, but useful for Bluetooth HCI socket access if using host BT adapter as secondary interface

### Docker-to-Host Communication

- ESP32 development board must be connected to host USB and visible as `/dev/ttyUSB*`
- Host must have USB-UART driver loaded for ESP32 board (`cp210x` is standard)
- Exploit logs and crash dumps via volume mount: `-v /host/output:/output`
- Pre-compiled ESP32 firmware is included in the repository; flashing can be done from within the container

---

## Install Instructions (Docker on Kali RPi 5)

> **IMPORTANT: RELEASE BINARIES ONLY** - BrakTooth source code is NOT available on the master branch. The exploit toolkit is distributed only as pre-built x86_64 Linux binaries via [GitHub Releases](https://github.com/Matheus-Garbelini/braktooth_esp32_bluetooth_classic_attacks/releases). The master branch contains only README.md and documentation.

> **WARNING: x86_64 BINARIES ONLY** - The pre-built release binaries are compiled for x86_64 Linux. They will NOT run natively on ARM64/RPi 5. Running on ARM64 would require QEMU user-mode emulation or rebuilding from source (source is not publicly available).

### Dockerfile (x86_64 only — reference for non-ARM systems)

```dockerfile
FROM debian:bullseye-slim

RUN apt-get update && apt-get install -y \
    wget \
    unzip \
    python3 \
    python3-serial \
    bluetooth \
    bluez \
    libbluetooth-dev \
    usbutils \
    esptool \
    && rm -rf /var/lib/apt/lists/*

# Download pre-built release binaries
RUN mkdir -p /opt/braktooth && \
    cd /opt/braktooth && \
    wget -q https://github.com/Matheus-Garbelini/braktooth_esp32_bluetooth_classic_attacks/releases/download/v1.0.1/release.zip && \
    unzip release.zip && \
    rm release.zip && \
    chmod +x wdissector/bin/bt_exploiter

WORKDIR /opt/braktooth

ENTRYPOINT ["/bin/bash"]
```

### Usage (x86_64 systems only)

```bash
# Download release binaries directly
wget https://github.com/Matheus-Garbelini/braktooth_esp32_bluetooth_classic_attacks/releases/download/v1.0.1/release.zip
unzip release.zip
cd release

# Flash ESP32 firmware (from the release package)
# esptool.py --port /dev/ttyUSB0 write_flash 0x0 <esp32_firmware.bin>

# Run the exploit tool (x86_64 binary)
# ./wdissector/bin/bt_exploiter --target AA:BB:CC:DD:EE:FF

# See exploit_modules_tutorial.pdf for detailed usage
```

### RPi 5 (ARM64) Workaround

```bash
# Option 1: QEMU user-mode emulation (slow but functional)
sudo apt install -y qemu-user-static binfmt-support
# x86_64 binaries will run via QEMU translation automatically

# Option 2: Use BlueToolkit instead
# BlueToolkit (sgxgsx/BlueToolkit) includes braktooth as a submodule
# and handles the binary download in its install.sh
```

---

## Kali Linux Raspberry Pi 5 Compatibility

### Architecture Support

**ARM64 INCOMPATIBLE (BINARY ONLY)** - BrakTooth is distributed only as pre-built x86_64 Linux binaries. The source code is not publicly available. The release binaries will not run natively on ARM64. QEMU user-mode emulation (`qemu-user-static`) can execute x86_64 binaries on ARM64 with a performance penalty. Alternatively, BlueToolkit (sgxgsx/BlueToolkit) integrates braktooth as a submodule.

### Hardware Constraints

- CPU: Host-side processing is lightweight (serial communication and exploit orchestration); Cortex-A76 is more than sufficient
- RAM: Minimal requirements (~200MB); well within 8GB
- Hardware: Requires an ESP32 DevKit board (ESP-WROOM-32 or ESP32-WROVER) as the attack radio. Standard USB-UART connection. Optionally uses the host Bluetooth adapter for scanning/enumeration

### Verdict

**INCOMPATIBLE (x86_64 ONLY)** - BrakTooth pre-built binaries are x86_64 Linux only and will not run natively on RPi 5 ARM64. Workarounds: (1) QEMU user-mode emulation via `qemu-user-static` (slow), (2) use BlueToolkit which integrates braktooth as a submodule. The ESP32 firmware flashing via esptool.py works on ARM64 regardless. Primary constraint is the closed-source x86_64 exploit binary.
