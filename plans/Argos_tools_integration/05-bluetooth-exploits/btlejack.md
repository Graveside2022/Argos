# Btlejack

> **RISK CLASSIFICATION**: HIGH RISK - SENSITIVE SOFTWARE
> BLE connection hijacking, sniffing, and jamming capability allowing interception and takeover of active BLE connections. Military education/training toolkit - Not for public release.

---

## Deployment Classification

> **RUNS ON ARGOS RPi 5: YES** â€” Pure Python; requires external micro:bit hardware for radio

| Method               | Supported | Notes                                                                    |
| -------------------- | --------- | ------------------------------------------------------------------------ |
| **Docker Container** | YES       | USB serial passthrough for micro:bit (`/dev/ttyACM*`); lightweight image |
| **Native Install**   | YES       | `pip install btlejack` on Kali ARM64; firmware flashing done on host     |

---

## Tool Description

Btlejack is a BLE (Bluetooth Low Energy) Swiss army knife that enables sniffing, jamming, and hijacking of existing BLE connections. It leverages BBC micro:bit hardware as an inexpensive BLE radio, exploiting the nRF51822 SoC to perform raw BLE link layer operations. Btlejack can recover hop interval, hop increment, and channel map from active connections, then either passively sniff traffic or actively hijack the connection by injecting packets at the link layer. Supports PCAP export for Wireshark analysis.

## Category

BLE Hijacking / Sniffing / Jamming

## Repository

https://github.com/virtualabs/btlejack

---

## Docker Compatibility Analysis

### Can it run in Docker?

**YES** - Btlejack runs in Docker with USB passthrough for the micro:bit hardware. The application is Python-based and communicates with micro:bit devices over USB serial.

### Host OS-Level Requirements

- `--device=/dev/ttyACM0` (or equivalent) - USB serial passthrough for micro:bit device(s)
- `--device=/dev/bus/usb` - Alternative broad USB passthrough
- `--privileged` - Required for raw USB serial access
- Host kernel modules: `cdc_acm` for micro:bit USB serial communication
- No `--net=host` required (communicates via USB serial, not network sockets)

### Docker-to-Host Communication

- micro:bit device(s) must be connected to host USB and visible as `/dev/ttyACM*`
- Host must have `cdc_acm` kernel module loaded (standard on Kali)
- PCAP output via volume mount: `-v /host/captures:/captures`
- For best results, use 3 micro:bit devices simultaneously (one per advertising channel: 37, 38, 39)

---

## Install Instructions (Docker on Kali RPi 5)

### Firmware Flashing (run on host first)

```bash
# Flash Btlejack firmware to micro:bit(s) before Docker use
pip3 install btlejack
btlejack -f  # Flashes firmware to connected micro:bit
```

### Dockerfile

```dockerfile
FROM kalilinux/kali-rolling:latest

RUN apt-get update && apt-get install -y \
    python3 \
    python3-pip \
    python3-venv \
    python3-serial \
    usbutils \
    && rm -rf /var/lib/apt/lists/*

RUN python3 -m venv /opt/btlejack/venv && \
    /opt/btlejack/venv/bin/pip install --upgrade pip && \
    /opt/btlejack/venv/bin/pip install btlejack

ENV PATH="/opt/btlejack/venv/bin:$PATH"

WORKDIR /captures

ENTRYPOINT ["btlejack"]
CMD ["--help"]
```

### Build and Run

```bash
# Build the image
docker build -t argos/btlejack .

# Run - scan for active BLE connections
docker run --rm -it \
  --privileged \
  --device=/dev/ttyACM0 \
  -v $(pwd)/captures:/captures \
  argos/btlejack -s

# Run - sniff a specific connection (by access address)
docker run --rm -it \
  --privileged \
  --device=/dev/ttyACM0 \
  -v $(pwd)/captures:/captures \
  argos/btlejack -f 0x12345678 -o /captures/sniff.pcap

# Run - with 3 micro:bits for full channel coverage
docker run --rm -it \
  --privileged \
  --device=/dev/ttyACM0 \
  --device=/dev/ttyACM1 \
  --device=/dev/ttyACM2 \
  -v $(pwd)/captures:/captures \
  argos/btlejack -s
```

---

## Kali Linux Raspberry Pi 5 Compatibility

### Architecture Support

**ARM64 SUPPORTED** - Btlejack is a pure Python package installable via pip on ARM64. The micro:bit firmware is architecture-independent (flashed to the nRF51822 SoC on the micro:bit). No platform-specific compiled extensions required.

### Hardware Constraints

- CPU: Minimal CPU requirements for serial communication and packet processing; Cortex-A76 is more than sufficient
- RAM: Very lightweight (~50-100MB); well within 8GB
- Hardware: Requires 1-3 BBC micro:bit v1 or v2 devices connected via USB. micro:bit uses nRF51822 (v1) or nRF52833 (v2) SoC for raw BLE radio access. More micro:bits provide faster connection detection across all three BLE advertising channels

### Verdict

**COMPATIBLE** - Btlejack runs natively on Kali ARM64 via pip install. Docker adds minimal overhead. The only constraint is the requirement for external micro:bit hardware, which is inexpensive and widely available.
