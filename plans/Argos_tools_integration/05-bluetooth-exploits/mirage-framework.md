# Mirage Framework

> **RISK CLASSIFICATION**: HIGH RISK - SENSITIVE SOFTWARE
> Multi-protocol wireless attack framework supporting BLE MITM, spoofing, fuzzing, and exploitation across BLE, ZigBee, Mosart, and IR protocols. Military education/training toolkit - Not for public release.

---

## Deployment Classification

> **RUNS ON ARGOS RPi 5: YES** â€” Python framework with optional C extensions; all dependencies available for ARM64

| Method               | Supported | Notes                                                               |
| -------------------- | --------- | ------------------------------------------------------------------- |
| **Docker Container** | YES       | Privileged mode + `--net=host` + USB passthrough for radio hardware |
| **Native Install**   | YES       | Install via `pip` on Kali ARM64; tested on ARM-based platforms      |

---

## Tool Description

Mirage is a modular offensive framework for wireless protocol security assessment supporting multiple protocols: Bluetooth Low Energy, ZigBee, Mosart, and Infrared. For BLE, it provides man-in-the-middle attacks, device cloning, MAC spoofing, GATT service enumeration, pairing interception, advertisement manipulation, and connection hijacking. The framework uses a plugin architecture where attack modules are loaded dynamically, and supports multiple hardware backends including HCI adapters, Ubertooth, micro:bit, Butterfly, and nRF52 boards. Provides both CLI and scripting interfaces.

## Category

Multi-Protocol Wireless Attack Framework

## Repository

https://github.com/RCayre/mirage

---

## Docker Compatibility Analysis

### Can it run in Docker?

**YES** - Mirage runs in Docker with appropriate hardware passthrough for the target protocol. BLE attacks require Bluetooth adapter or compatible radio hardware. ZigBee requires a ZigBee radio (e.g., Atmel RZUSBstick, HackRF). Each protocol module has its own hardware requirements.

### Host OS-Level Requirements

- `--privileged` - Required for raw HCI socket access and USB device interaction
- `--net=host` - Required for Bluetooth HCI stack communication
- `--device=/dev/bus/usb` - USB passthrough for all supported radio hardware
- `--device=/dev/ttyUSB*` or `--device=/dev/ttyACM*` - Serial devices for micro:bit, nRF52, ButteRFly
- Host kernel modules: `bluetooth`, `btusb` (BLE), `cdc_acm` (micro:bit/nRF52), protocol-specific drivers as needed

### Docker-to-Host Communication

- Host must have appropriate radio hardware connected and drivers loaded
- Bluetooth adapter must be visible via `hciconfig` for BLE modules
- Serial devices must be accessible for micro:bit and nRF52-based modules
- D-Bus socket sharing for BlueZ integration: `-v /var/run/dbus:/var/run/dbus`
- Output and logs via volume mount: `-v /host/output:/output`

---

## Install Instructions (Docker on Kali RPi 5)

### Dockerfile

```dockerfile
FROM kalilinux/kali-rolling:latest

RUN apt-get update && apt-get install -y \
    python3 \
    python3-pip \
    python3-venv \
    python3-dev \
    python3-serial \
    python3-dbus \
    git \
    build-essential \
    pkg-config \
    libbluetooth-dev \
    libglib2.0-dev \
    libdbus-1-dev \
    bluetooth \
    bluez \
    bluez-tools \
    usbutils \
    && rm -rf /var/lib/apt/lists/*

RUN git clone --depth 1 \
    https://github.com/RCayre/mirage.git /opt/mirage

WORKDIR /opt/mirage

RUN python3 -m venv /opt/mirage/venv && \
    /opt/mirage/venv/bin/pip install --upgrade pip && \
    /opt/mirage/venv/bin/pip install -r requirements.txt 2>/dev/null || true && \
    /opt/mirage/venv/bin/pip install .

ENV PATH="/opt/mirage/venv/bin:$PATH"

ENTRYPOINT ["mirage"]
CMD ["--help"]
```

### Build and Run

```bash
# Build the image
docker build -t argos/mirage .

# Ensure Bluetooth adapter is up on host
sudo hciconfig hci0 up

# Run - list available modules
docker run --rm -it \
  --privileged \
  --net=host \
  --device=/dev/bus/usb \
  -v /var/run/dbus:/var/run/dbus \
  argos/mirage --list-modules

# Run - BLE device scanning
docker run --rm -it \
  --privileged \
  --net=host \
  --device=/dev/bus/usb \
  -v /var/run/dbus:/var/run/dbus \
  argos/mirage ble_scan

# Run - BLE MITM attack (requires 2 BLE adapters)
docker run --rm -it \
  --privileged \
  --net=host \
  --device=/dev/bus/usb \
  -v /var/run/dbus:/var/run/dbus \
  -v $(pwd)/output:/output \
  argos/mirage ble_mitm \
    --target AA:BB:CC:DD:EE:FF \
    --interface hci0 \
    --interface2 hci1

# Run - BLE device cloning
docker run --rm -it \
  --privileged \
  --net=host \
  --device=/dev/bus/usb \
  -v /var/run/dbus:/var/run/dbus \
  argos/mirage ble_clone --target AA:BB:CC:DD:EE:FF
```

---

## Kali Linux Raspberry Pi 5 Compatibility

### Architecture Support

**ARM64 COMPATIBLE** - Mirage is a Python framework with optional C extensions that compile on ARM64. All core dependencies (PyBluez, pyserial, pycryptodome, dbus-python) are available for ARM64 on Kali Linux. The framework has been tested on ARM-based platforms.

### Hardware Constraints

- CPU: Python-based framework with moderate CPU usage during active attacks (MITM, fuzzing); 4x Cortex-A76 handles all modules comfortably
- RAM: ~200-400MB depending on active modules; well within 8GB
- Hardware: Protocol-dependent requirements:
    - BLE: Standard HCI Bluetooth adapter (RPi 5 onboard or external USB); MITM requires 2 adapters
    - ZigBee: Compatible ZigBee radio (Atmel RZUSBstick, HackRF with gr-ieee802-15-4)
    - Mosart: Compatible Mosart dongle
    - IR: IR transceiver
- Note: BLE attacks work with the RPi 5 onboard Bluetooth plus one external USB adapter for MITM

### Verdict

**COMPATIBLE** - Mirage runs natively on Kali ARM64. Docker deployment works with privileged mode and hardware passthrough. The modular architecture means only the hardware for the target protocol is needed. BLE modules work out of the box with standard Bluetooth adapters.
