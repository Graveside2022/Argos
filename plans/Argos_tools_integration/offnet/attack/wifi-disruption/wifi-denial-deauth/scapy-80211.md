# Scapy 802.11 (Custom Frame Crafting)

> **RISK CLASSIFICATION**: HIGH RISK - SENSITIVE SOFTWARE
> Custom 802.11 frame crafting library enabling beacon injection, probe response spoofing, deauthentication frame generation, EAP/EAPOL manipulation, and arbitrary wireless frame construction. Military education/training toolkit - Not for public release.

---

## Deployment Classification

> **RUNS ON ARGOS RPi 5: YES** â€” Pure Python library; installs identically on ARM64 and x86_64 via pip or apt

| Method               | Supported | Notes                                                                                             |
| -------------------- | --------- | ------------------------------------------------------------------------------------------------- |
| **Docker Container** | YES       | Requires `--privileged`, `--net=host`, USB passthrough for 802.11 operations; trivial pip install |
| **Native Install**   | YES       | `apt install python3-scapy` or `pip3 install scapy` on Kali ARM64; recommended                    |

---

## Tool Description

Scapy is the Python-based interactive packet manipulation library and program. In the context of 802.11 WiFi exploitation, Scapy provides the foundational layer for crafting arbitrary wireless frames at the lowest level. Unlike purpose-built tools (mdk4, aireplay-ng), Scapy gives the operator complete control over every byte in a wireless frame. Key 802.11 capabilities include: beacon frame injection (creating fake access points with arbitrary SSIDs, capabilities, and security parameters), probe request/response spoofing (impersonating clients or APs), deauthentication and disassociation frame crafting, EAP/EAPOL frame manipulation (targeting WPA/WPA2 handshakes), custom management/control/data frame construction, PMKID extraction assistance, and 802.11w (Protected Management Frames) testing. Scapy's `Dot11`, `Dot11Beacon`, `Dot11Elt`, `Dot11Auth`, `Dot11Deauth`, `EAPOL`, and `EAP` layers provide full protocol coverage. Combined with a monitor-mode adapter, Scapy enables rapid prototyping of novel wireless attacks and protocol research.

## Category

802.11 Frame Crafting / Wireless Protocol Manipulation Library

## Repository

- **GitHub**: https://github.com/secdev/scapy
- **Language**: Python
- **License**: GPL-2.0
- **Stars**: ~12,000

---

## Docker Compatibility Analysis

### Can it run in Docker?

**YES** -- Scapy is a pure Python library that installs trivially via pip. All 802.11 frame crafting and injection works in Docker with appropriate privileged access to the wireless adapter.

### Host OS-Level Requirements

- `--privileged` -- Required for raw 802.11 frame injection, sniffing, and monitor mode interface control
- `--net=host` -- Required for direct access to host wireless interfaces in monitor mode
- `--device=/dev/bus/usb` -- USB passthrough for external WiFi adapter (Alfa AWUS036AXML)
- Host kernel modules: `cfg80211`, `mac80211`, `mt76x2u` (Alfa adapter driver)
- WiFi adapter must be in monitor mode for 802.11 frame injection/capture

### Docker-to-Host Communication

- Monitor mode interface must be configured on the host (`airmon-ng start wlan1` or `iw dev wlan1 set type monitor`)
- No network port mappings required for raw 802.11 operations (operates below IP layer)
- Packet captures and scripts shared via volume mount: `-v /host/scripts:/scripts`
- Interactive Python shell recommended for exploratory frame crafting

---

## Install Instructions (Docker on Kali RPi 5)

### Option A: Native Install (Recommended)

```bash
sudo apt update
sudo apt install -y python3-scapy aircrack-ng iw wireless-tools tcpdump

# Or via pip for latest version
pip3 install scapy
```

### Option B: Docker

```dockerfile
FROM python:3.11-slim

RUN apt-get update && apt-get install -y \
    iw \
    wireless-tools \
    aircrack-ng \
    net-tools \
    tcpdump \
    && rm -rf /var/lib/apt/lists/*

RUN pip install --no-cache-dir scapy

WORKDIR /scripts
ENTRYPOINT ["python3"]
```

```bash
# Build
docker build -t argos/scapy-80211 .

# Prepare monitor mode on host (run before container)
sudo airmon-ng start wlan1

# Run - interactive Scapy shell for 802.11 frame crafting
docker run --rm -it \
  --privileged \
  --net=host \
  -v /dev/bus/usb:/dev/bus/usb \
  -v $(pwd)/scripts:/scripts \
  --entrypoint scapy \
  argos/scapy-80211

# Run - execute a custom 802.11 script (e.g., beacon injection)
docker run --rm -it \
  --privileged \
  --net=host \
  -v /dev/bus/usb:/dev/bus/usb \
  -v $(pwd)/scripts:/scripts \
  argos/scapy-80211 /scripts/beacon_inject.py

# Run - passive 802.11 sniffing and frame analysis
docker run --rm -it \
  --privileged \
  --net=host \
  -v /dev/bus/usb:/dev/bus/usb \
  -v $(pwd)/captures:/captures \
  --entrypoint python3 \
  argos/scapy-80211 -c "from scapy.all import *; sniff(iface='wlan1mon', prn=lambda p: p.summary(), count=100)"

# Example: Craft and send a deauthentication frame
docker run --rm -it \
  --privileged \
  --net=host \
  -v /dev/bus/usb:/dev/bus/usb \
  --entrypoint python3 \
  argos/scapy-80211 -c "
from scapy.all import *
dot11 = Dot11(addr1='FF:FF:FF:FF:FF:FF', addr2='AA:BB:CC:DD:EE:FF', addr3='AA:BB:CC:DD:EE:FF')
frame = RadioTap()/dot11/Dot11Deauth(reason=7)
sendp(frame, iface='wlan1mon', count=10, inter=0.1)
"
```

---

## Kali Linux Raspberry Pi 5 Compatibility

### Architecture Support

**ARM64 NATIVE** -- Scapy is a pure Python library with no native C extensions requiring compilation. It installs identically on ARM64 and x86_64 via pip or apt. The `python3-scapy` package is available in Kali ARM64 repositories.

### Hardware Constraints

- CPU: Pure Python -- frame crafting and injection are not CPU-intensive. Complex sniffing with callback processing may use moderate CPU on high-traffic networks, but well within Cortex-A76 capabilities
- RAM: Base library uses ~50-80MB. Large packet captures held in memory can grow; use `wrpcap()` to write to disk for long captures. 8GB is more than sufficient
- WiFi: Requires adapter with monitor mode and packet injection support. Alfa AWUS036AXML (mt76x2u) is fully compatible with all Scapy 802.11 operations
- No GPU or additional hardware required

### Verdict

**COMPATIBLE** -- Scapy is the most versatile tool in the WiFi exploit category. As a pure Python library, it runs identically on RPi5 ARM64 as on any other platform. It serves as the foundation layer for many other WiFi tools (wifiphisher, fragattacks, krackattacks). Install via `apt install python3-scapy` or `pip3 install scapy`. Essential for custom 802.11 research, rapid attack prototyping, and any scenario where purpose-built tools lack the required flexibility.
