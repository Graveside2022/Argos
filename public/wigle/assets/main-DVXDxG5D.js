const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/leaflet-Dgihpmma.css"])))=>i.map(i=>d[i]);
import{p as oe,f as $,a as dt,r as vt,g as t,u as ze,s as ut,n as pt,c as n,b as g,d as Pe,e as z,h as rt,i as B,j as a,t as M,k as ke,l as _t,m as S,o as r,q as Lt,w as ot,v as Ze,x as zt,y as Ke,z as et,A as Je,B as _e,C as Ye,D as Be,E as yt,F as Tt,G as Ee,H as Le,I as Ft,J as Fe,K as Dt,L as nt,M as fe,N as Et,O as Kt,P as kt}from"./vendor-p8hDesqD.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))d(v);new MutationObserver(v=>{for(const p of v)if(p.type==="childList")for(const f of p.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&d(f)}).observe(document,{childList:!0,subtree:!0});function s(v){const p={};return v.integrity&&(p.integrity=v.integrity),v.referrerPolicy&&(p.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?p.credentials="include":v.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function d(v){if(v.ep)return;v.ep=!0;const p=s(v);fetch(v.href,p)}})();const Bt="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Bt);var qt=$("<button><!></button>");function ge(u,e){let s=oe(e,"variant",3,"primary"),d=oe(e,"size",3,"md"),v=oe(e,"disabled",3,!1),p=oe(e,"class",3,""),f=vt(e,["$$slots","$$events","$$legacy","variant","size","disabled","class","children"]);const o={primary:"bg-primary-600 text-white hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600",secondary:"bg-secondary-600 text-white hover:bg-secondary-700 dark:bg-secondary-500 dark:hover:bg-secondary-600",outline:"border-2 border-surface-300 text-surface-700 hover:bg-surface-100 dark:border-surface-600 dark:text-surface-300 dark:hover:bg-surface-800",ghost:"text-surface-700 hover:bg-surface-100 dark:text-surface-300 dark:hover:bg-surface-800",danger:"bg-error text-white hover:bg-red-700"},c={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"},i="inline-flex items-center justify-center font-medium rounded-md transition-colors duration-200 focus-ring disabled:opacity-50 disabled:cursor-not-allowed",b=ze(()=>`${i} ${o[s()]} ${c[d()]} ${p()}`);var w=qt();dt(w,()=>({class:t(b),disabled:v(),...f}));var y=n(w);ut(y,()=>e.children??pt),g(u,w)}var Ot=$("<div><!></div>");function De(u,e){let s=oe(e,"variant",3,"default"),d=oe(e,"padding",3,"md"),v=oe(e,"class",3,""),p=vt(e,["$$slots","$$events","$$legacy","variant","padding","class","children"]);const f={default:"bg-surface-100 dark:bg-surface-800",elevated:"bg-surface-100 dark:bg-surface-800 shadow-lg",bordered:"bg-surface-50 dark:bg-surface-900 border border-surface-300 dark:border-surface-700"},o={none:"",sm:"p-3",md:"p-6",lg:"p-8"},c="rounded-lg transition-colors duration-200",i=ze(()=>`${c} ${f[s()]} ${o[d()]} ${v()}`);var b=Ot();dt(b,()=>({class:t(i),...p}));var w=n(b);ut(w,()=>e.children??pt),g(u,b)}var Ht=(u,e,s)=>{e()&&(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),s())},Wt=Lt('<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>'),Nt=$('<div><h3 class="text-lg font-semibold text-surface-900 dark:text-surface-100"> </h3> <!></div>'),Ut=$('<div class="p-6 animate-fade-in"><!></div>'),Gt=$("<div><!> <!></div>");function st(u,e){let s=oe(e,"title",3,""),d=oe(e,"collapsible",3,!1),v=oe(e,"defaultExpanded",3,!0),p=oe(e,"class",3,""),f=vt(e,["$$slots","$$events","$$legacy","title","collapsible","defaultExpanded","class","children"]),o=z(rt(v()));function c(){d()&&r(o,!t(o))}var i=Gt();dt(i,()=>({class:`bg-surface-100 dark:bg-surface-800 rounded-lg overflow-hidden ${p()??""}`,...f}));var b=n(i);{var w=q=>{var W=Nt();let Y;W.__click=c,W.__keydown=[Ht,d,c];var ae=n(W),C=n(ae),A=a(ae,2);{var Z=m=>{var F=Wt();let l;M(k=>l=ke(F,0,"w-5 h-5 text-surface-500 transition-transform duration-200",null,l,k),[()=>({"rotate-180":!t(o)})]),g(m,F)};B(A,m=>{d()&&m(Z)})}M(m=>{Y=ke(W,1,"px-6 py-4 border-b border-surface-200 dark:border-surface-700 flex items-center justify-between",null,Y,m),_t(W,"role",d()?"button":void 0),_t(W,"tabindex",d()?0:void 0),S(C,s())},[()=>({"cursor-pointer":d()})]),g(q,W)};B(b,q=>{s()&&q(w)})}var y=a(b,2);{var H=q=>{var W=Ut(),Y=n(W);ut(Y,()=>e.children??pt),g(q,W)};B(y,q=>{t(o)&&q(H)})}g(u,i)}Pe(["click","keydown"]);var Vt=$("<div><!></div>");function at(u,e){let s=oe(e,"cols",3,1),d=oe(e,"gap",3,"md"),v=oe(e,"responsive",3,!0),p=oe(e,"class",3,""),f=vt(e,["$$slots","$$events","$$legacy","cols","gap","responsive","class","children"]);const o={none:"gap-0",sm:"gap-2",md:"gap-4",lg:"gap-6"},c={1:"grid-cols-1",2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",6:"grid-cols-6",12:"grid-cols-12"},i={1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 md:grid-cols-2 lg:grid-cols-4",6:"grid-cols-2 md:grid-cols-3 lg:grid-cols-6",12:"grid-cols-3 md:grid-cols-6 lg:grid-cols-12"},b=ze(()=>`grid ${o[d()]} ${v()?i[s()]:c[s()]} ${p()}`);var w=Vt();dt(w,()=>({class:t(b),...f}));var y=n(w);ut(y,()=>e.children??pt),g(u,w)}Pe(["mousedown"]);function Pt(){if(typeof window>"u")return"system";const u=localStorage.getItem("theme");return u&&["light","dark","system"].includes(u)?u:"system"}const $t=ot(Pt());$t.subscribe(u=>{typeof window>"u"||(localStorage.setItem("theme",u),wt(u))});Ze($t,u=>u!=="system"?u:typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");function wt(u){if(typeof document>"u")return;u==="dark"||u==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",u=>{$t.update(e=>(e==="system"&&wt("system"),e))});typeof window<"u"&&wt(Pt());Pe(["click"]);Pe(["keydown","click"]);class Xt{socket=null;config;events;reconnectTimer=null;isManuallyDisconnected=!1;constructor(e,s={}){this.config={autoConnect:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,transports:["websocket","polling"],path:"/socket.io/",extraHeaders:{},...e},this.events=s,this.config.autoConnect&&this.connect()}connect(){if(this.socket?.connected){console.warn("WebSocket already connected");return}this.isManuallyDisconnected=!1;try{this.socket=zt(this.config.url,{reconnection:this.config.reconnection,reconnectionAttempts:this.config.reconnectionAttempts,reconnectionDelay:this.config.reconnectionDelay,reconnectionDelayMax:this.config.reconnectionDelayMax,timeout:this.config.timeout,transports:this.config.transports,path:this.config.path,extraHeaders:this.config.extraHeaders}),this.setupEventHandlers()}catch(e){this.handleError(e)}}disconnect(){this.isManuallyDisconnected=!0,this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.socket&&(this.socket.disconnect(),this.socket=null)}send(e,s){if(!this.socket?.connected)throw new Error("WebSocket is not connected");const d={type:e,payload:s,timestamp:Date.now()};this.socket.emit("message",d)}emit(e,s){if(!this.socket?.connected)throw new Error("WebSocket is not connected");this.socket.emit(e,s)}on(e,s){if(!this.socket)throw new Error("WebSocket is not initialized");this.socket.on(e,s)}off(e,s){this.socket&&(s?this.socket.off(e,s):this.socket.off(e))}get isConnected(){return this.socket?.connected??!1}get id(){return this.socket?.id}setupEventHandlers(){this.socket&&(this.socket.on("connect",()=>{console.log(`WebSocket connected to ${this.config.url}`),this.events.onConnect?.()}),this.socket.on("disconnect",e=>{console.log(`WebSocket disconnected from ${this.config.url}: ${e}`),this.events.onDisconnect?.(e),!this.isManuallyDisconnected&&this.config.reconnection&&this.handleReconnection()}),this.socket.on("connect_error",e=>{this.handleError(e)}),this.socket.on("message",e=>{this.events.onMessage?.(e)}),this.socket.io.on("reconnect_attempt",e=>{console.log(`Reconnection attempt ${e} to ${this.config.url}`),this.events.onReconnectAttempt?.(e)}),this.socket.io.on("reconnect_failed",()=>{console.error(`Failed to reconnect to ${this.config.url}`),this.events.onReconnectFailed?.()}),this.socket.io.on("reconnect",e=>{console.log(`Reconnected to ${this.config.url} after ${e} attempts`),this.events.onReconnect?.(e)}))}handleError(e){console.error(`WebSocket error for ${this.config.url}:`,e),this.events.onError?.(e)}handleReconnection(){console.log(`Attempting to reconnect to ${this.config.url}`)}destroy(){this.disconnect(),this.events={}}}const xt="8092",St="8000",Ct="2501";function Xe(u,e="http"){{const s=typeof window<"u"?window.location:null;if(s){const d=s.hostname;return`${e==="ws"?s.protocol==="https:"?"wss:":"ws:":s.protocol}//${d}:${u}`}return""}}const It={hackrf:{http:Xe(xt,"http"),ws:Xe(xt,"ws"),api:"/api/hackrf"},wigle:{http:Xe(St,"http"),ws:Xe(St,"ws"),api:"/api"},kismet:{http:Xe(Ct,"http"),ws:Xe(Ct,"ws"),api:"/api"}};function Jt(u){return It[u].ws}function Qt(u){return It[u].http}const Te=ot({connected:!1,connecting:!1,error:null,lastConnected:null,reconnectAttempts:0}),ct=ot(new Map),Yt=ot(null),Zt=ot([]);let Qe=null;function es(u){const e=Jt("wigle");if(Qe?.isConnected){console.warn("Wigle WebSocket already connected");return}Te.update(s=>({...s,connecting:!0,error:null})),Qe=new Xt({url:e,path:"/socket.io/",reconnection:!0,reconnectionAttempts:10,reconnectionDelay:2e3,reconnectionDelayMax:1e4},{onConnect:()=>{Te.update(s=>({...s,connected:!0,connecting:!1,lastConnected:new Date,reconnectAttempts:0})),Qe?.emit("get_devices")},onDisconnect:s=>{Te.update(d=>({...d,connected:!1,connecting:!1}))},onError:s=>{Te.update(d=>({...d,error:s,connecting:!1}))},onMessage:s=>{ss(s)},onReconnectAttempt:s=>{Te.update(d=>({...d,connecting:!0,reconnectAttempts:s}))}})}function ts(){Qe&&(Qe.disconnect(),Qe=null),Te.set({connected:!1,connecting:!1,error:null,lastConnected:null,reconnectAttempts:0})}function ss(u){switch(u.type){case"device_new":case"device_update":const e=u.payload,s=e.mac||e.id;ct.update(p=>(p.set(s,e),new Map(p))),Zt.update(p=>[e,...p.filter(o=>(o.mac||o.id)!==s)].slice(0,50));break;case"device_lost":const d=u.payload,v=d.mac||d.id;ct.update(p=>(p.delete(v),new Map(p)));break;case"scan_status":Yt.set(u.payload);break;default:console.log("Unknown Wigle message type:",u.type)}}const jt=Ze(Te,u=>u.connected);Ze(Te,u=>u.connecting);const as=Ze(Te,u=>u.error),ns=Ze(ct,u=>u.size),bt=Ze(ct,u=>Array.from(u.values()));class rs{baseURL;authConfig;requestInterceptors=[];responseInterceptors=[];defaultTimeout=3e4;defaultRetries=3;defaultRetryDelay=1e3;constructor(e,s){this.baseURL=e.replace(/\/$/,""),this.authConfig=s}addRequestInterceptor(e){this.requestInterceptors.push(e)}addResponseInterceptor(e){this.responseInterceptors.push(e)}applyAuth(e){if(!this.authConfig)return e;const s={...e.headers};switch(this.authConfig.type){case"apiKey":this.authConfig.headerName&&this.authConfig.credentials?s[this.authConfig.headerName]=this.authConfig.credentials:this.authConfig.paramName&&this.authConfig.credentials&&(e.params={...e.params,[this.authConfig.paramName]:this.authConfig.credentials});break;case"bearer":this.authConfig.credentials&&(s.Authorization=`Bearer ${this.authConfig.credentials}`);break;case"basic":this.authConfig.credentials&&(s.Authorization=`Basic ${this.authConfig.credentials}`);break}return{...e,headers:s}}async applyRequestInterceptors(e){let s=e;for(const d of this.requestInterceptors)try{d.onRequest&&(s=await d.onRequest(s))}catch(v){throw d.onError&&await d.onError(v),v}return s}async applyResponseInterceptors(e){let s=e;for(const d of this.responseInterceptors)try{d.onResponse&&(s=await d.onResponse(s))}catch(v){throw d.onError&&await d.onError(v),v}return s}buildURL(e){return e.startsWith("http://")||e.startsWith("https://")?e:`${this.baseURL}/${e.replace(/^\//,"")}`}buildQueryString(e){if(!e||Object.keys(e).length===0)return"";const s=new URLSearchParams;return Object.entries(e).forEach(([d,v])=>{v!=null&&(Array.isArray(v)?v.forEach(p=>s.append(d,String(p))):s.append(d,String(v)))}),s.toString()}async executeRequest(e){const s=e.retries??this.defaultRetries,d=e.retryDelay??this.defaultRetryDelay;let v;for(let p=0;p<=s;p++)try{const f=this.buildQueryString(e.params),o=this.buildURL(e.url)+(f?`?${f}`:""),c={method:e.method||"GET",headers:{"Content-Type":"application/json",...e.headers},signal:e.signal,credentials:e.withCredentials?"include":"same-origin"};e.data&&e.method!=="GET"&&(e.data instanceof FormData?(delete c.headers["Content-Type"],c.body=e.data):c.body=JSON.stringify(e.data));const i=e.timeout??this.defaultTimeout,b=new AbortController,w=setTimeout(()=>b.abort(),i);e.signal||(c.signal=b.signal);try{const y=await fetch(o,c);clearTimeout(w);let H;switch(e.responseType||"json"){case"json":H=await y.json();break;case"text":H=await y.text();break;case"blob":H=await y.blob();break;case"arraybuffer":H=await y.arrayBuffer();break;default:H=await y.json()}const W={};y.headers.forEach((ae,C)=>{W[C]=ae});const Y={data:H,status:y.status,statusText:y.statusText,headers:W,config:e};if(!y.ok)throw{message:`HTTP ${y.status}: ${y.statusText}`,status:y.status,response:Y,request:e};return Y}catch(y){throw clearTimeout(w),y}}catch(f){if(v=f,f instanceof Error&&(f.name==="AbortError"||f.status===401))throw this.createApiError(f,e);if(p===s)throw this.createApiError(v,e);console.warn(`Request failed, retrying (${p+1}/${s})...`,f),await this.delay(d*Math.pow(2,p))}throw this.createApiError(v,e)}createApiError(e,s){const d={message:e.message||"Unknown error occurred",request:s};return e.status&&(d.status=e.status),e.response&&(d.response=e.response),d}delay(e){return new Promise(s=>setTimeout(s,e))}async request(e){try{let s=this.applyAuth(e);s=await this.applyRequestInterceptors(s);const d=await this.executeRequest(s),v=await this.applyResponseInterceptors(d);return this.logRequest(s,v),v}catch(s){this.logError(e,s);for(const d of this.responseInterceptors)if(d.onError)try{await d.onError(s)}catch(v){throw v}throw s}}get(e,s){return this.request({...s,url:e,method:"GET"})}post(e,s,d){return this.request({...d,url:e,method:"POST",data:s})}put(e,s,d){return this.request({...d,url:e,method:"PUT",data:s})}delete(e,s){return this.request({...s,url:e,method:"DELETE"})}patch(e,s,d){return this.request({...d,url:e,method:"PATCH",data:s})}logRequest(e,s){}logError(e,s){console.error(`[API Error] ${e.method} ${e.url}`,{config:e,error:s})}setAuth(e){this.authConfig=e}clearAuth(){this.authConfig=void 0}}class ft extends rs{constructor(e){const s=e||Qt("wigle");super(s),this.addRequestInterceptor({onRequest:d=>(console.log("[Wigle API] Request:",d.method,d.url),d)})}async getDevices(e){return this.get("/api/devices",{params:e})}async getDevice(e){return this.get(`/api/devices/${e}`)}async getDeviceHistory(e,s=24){return this.get(`/api/devices/${e}/history`,{params:{hours:s}})}async updateDevice(e,s){return this.patch(`/api/devices/${e}`,s)}async deleteDevice(e){return this.delete(`/api/devices/${e}`)}async clearDevices(e){return this.post("/api/devices/clear",e)}async startScan(e){return this.post("/api/scan/start",e)}async stopScan(){return this.post("/api/scan/stop")}async getScanStatus(){return this.get("/api/scan/status")}async getScanSettings(){return this.get("/api/scan/settings")}async updateScanSettings(e){return this.post("/api/scan/settings",e)}async getTAKConfig(){return this.get("/api/tak/config")}async updateTAKConfig(e){return this.post("/api/tak/config",e)}async getTAKStatus(){return this.get("/api/tak/status")}async connectTAK(){return this.post("/api/tak/connect")}async disconnectTAK(){return this.post("/api/tak/disconnect")}async sendTAKMessage(e){return this.post("/api/tak/send",e)}async getTAKMessages(e=100){return this.get("/api/tak/messages",{params:{limit:e}})}async getStats(){return this.get("/api/stats")}async getManufacturerStats(){return this.get("/api/stats/manufacturers")}async getSignalDistribution(){return this.get("/api/stats/signals")}async getActivityTimeline(e=24){return this.get("/api/stats/timeline",{params:{hours:e}})}async importWigleCSV(e){const s=new FormData;return s.append("file",e),this.post("/api/import/wigle",s,{headers:{},timeout:12e4})}async exportDevices(e="csv"){return this.get("/api/export/devices",{params:{format:e},responseType:"blob"})}async exportTAKMessages(e="xml"){return this.get("/api/export/tak",{params:{format:e},responseType:"blob"})}async getAntennaConfig(){return this.get("/api/antenna/config")}async updateAntennaConfig(e){return this.post("/api/antenna/config",e)}async calibrateAntenna(){return this.post("/api/antenna/calibrate")}async getAlerts(){return this.get("/api/alerts")}async markAlertRead(e){return this.post(`/api/alerts/${e}/read`)}async clearAlerts(){return this.post("/api/alerts/clear")}async getGeofences(){return this.get("/api/geofences")}async createGeofence(e){return this.post("/api/geofences",e)}async updateGeofence(e,s){return this.patch(`/api/geofences/${e}`,s)}async deleteGeofence(e){return this.delete(`/api/geofences/${e}`)}async getHeatMapData(e){return this.get("/api/heatmap",{params:e})}}var os=$('<div class="filters svelte-13sgnrt"><div class="search-bar svelte-13sgnrt"><input type="text" placeholder="Search by MAC, SSID, or manufacturer..." class="search-input svelte-13sgnrt"/></div> <div class="filter-controls svelte-13sgnrt"><div class="filter-group svelte-13sgnrt"><label class="svelte-13sgnrt">Type:</label> <select class="filter-select svelte-13sgnrt"><option>All</option><option>Access Points</option><option>Clients</option></select></div> <div class="filter-group svelte-13sgnrt"><label class="svelte-13sgnrt">Seen:</label> <select class="filter-select svelte-13sgnrt"><option>All</option><option>Recent (1h)</option><option>Active (5m)</option></select></div> <div class="filter-group svelte-13sgnrt"><label class="svelte-13sgnrt">Min Signal:</label> <input type="range" min="-100" max="-30" class="signal-slider svelte-13sgnrt"/> <span class="signal-value svelte-13sgnrt"> </span></div></div></div>'),is=$("<p>Loading devices...</p>"),ls=$("<p>No devices found matching filters</p>"),cs=$('<div class="info-row svelte-13sgnrt"><span class="label svelte-13sgnrt">Vendor:</span> <span class="value svelte-13sgnrt"> </span></div>'),ds=$('<div class="info-row svelte-13sgnrt"><span class="label svelte-13sgnrt">Location:</span> <span class="value svelte-13sgnrt"> </span></div>'),vs=$('<div class="device-header svelte-13sgnrt"><span class="device-icon svelte-13sgnrt"> </span> <h3 class="device-ssid svelte-13sgnrt"> </h3> <span class="device-type svelte-13sgnrt"> </span></div> <div class="device-info svelte-13sgnrt"><div class="info-row svelte-13sgnrt"><span class="label svelte-13sgnrt">MAC:</span> <span class="value mac svelte-13sgnrt"> </span></div> <!> <div class="info-row svelte-13sgnrt"><span class="label svelte-13sgnrt">Signal:</span> <span> </span></div> <div class="info-row svelte-13sgnrt"><span class="label svelte-13sgnrt">Channel:</span> <span class="value svelte-13sgnrt"> </span></div> <!> <div class="info-row svelte-13sgnrt"><span class="label svelte-13sgnrt">Last seen:</span> <span class="value svelte-13sgnrt"> </span></div></div>',1),us=$('<span class="connection-status connected svelte-13sgnrt">🟢 Live updates</span>'),ps=$('<span class="connection-status disconnected svelte-13sgnrt">🔴 Offline</span>'),fs=$('<div class="device-list svelte-13sgnrt"><!> <div class="device-grid svelte-13sgnrt"><!></div> <div class="device-stats svelte-13sgnrt"><span> </span> <!></div></div>');function gs(u,e){Ke(e,!0);const[s,d]=yt(),v=()=>Je(bt,"$deviceList",s),p=()=>Je(jt,"$isConnected",s);let f=z(""),o=z("All"),c=z("all"),i=z(-100),b=z(!1),w;const y=ze(()=>{let h=v();if(t(f)){const I=t(f).toLowerCase();h=h.filter(Q=>Q.mac.toLowerCase().includes(I)||Q.ssid?.toLowerCase().includes(I)||Q.manufacturer?.toLowerCase().includes(I))}t(o)!=="All"&&(h=h.filter(I=>I.type===t(o))),h=h.filter(I=>I.signal>=t(i));const L=Date.now(),U=5*60*1e3,J=60*60*1e3;return t(c)==="active"?h=h.filter(I=>L-I.lastSeen<U):t(c)==="recent"&&(h=h.filter(I=>L-I.lastSeen<J)),h.sort((I,Q)=>Q.signal-I.signal)});et(()=>{w=new ft,p()||H()});async function H(){r(b,!0);try{const h={type:t(o),minSignal:t(i),seen:t(c)},L=await w.getDevices(h);L.data&&console.log("Loaded devices:",L.data)}catch(h){console.error("Failed to load devices:",h)}finally{r(b,!1)}}function q(h){return`${h} dBm`}function W(h){const L=new Date(h),J=Date.now()-h;return J<6e4?"Just now":J<36e5?`${Math.floor(J/6e4)}m ago`:J<864e5?`${Math.floor(J/36e5)}h ago`:L.toLocaleString()}function Y(h){return h>=-50?"signal-excellent":h>=-60?"signal-good":h>=-70?"signal-fair":h>=-80?"signal-weak":"signal-poor"}function ae(h){return h.type==="AP"?"📡":"📱"}var C=fs(),A=n(C);De(A,{class:"filter-card",children:(h,L)=>{var U=os(),J=n(U),I=n(J),Q=a(J,2),D=n(Q),E=a(n(D),2),T=n(E);T.value=T.__value="All";var j=a(T);j.value=j.__value="AP";var N=a(j);N.value=N.__value="Client";var G=a(D,2),ce=a(n(G),2),ie=n(ce);ie.value=ie.__value="all";var re=a(ie);re.value=re.__value="recent";var de=a(re);de.value=de.__value="active";var ye=a(G,2),ve=a(n(ye),2),le=a(ve,2),he=n(le);M(te=>S(he,te),[()=>q(t(i))]),_e(I,()=>t(f),te=>r(f,te)),Ye(E,()=>t(o),te=>r(o,te)),Ye(ce,()=>t(c),te=>r(c,te)),_e(ve,()=>t(i),te=>r(i,te)),g(h,U)},$$slots:{default:!0}});var Z=a(A,2),m=n(Z);{var F=h=>{De(h,{class:"loading-card",children:(L,U)=>{var J=is();g(L,J)},$$slots:{default:!0}})},l=(h,L)=>{{var U=I=>{De(I,{class:"empty-card",children:(Q,D)=>{var E=ls();g(Q,E)},$$slots:{default:!0}})},J=I=>{var Q=Tt(),D=Ee(Q);Le(D,17,()=>t(y),E=>E.mac,(E,T)=>{De(E,{class:"device-card",onclick:()=>e.onDeviceSelect?.(t(T)),children:(j,N)=>{var G=vs(),ce=Ee(G),ie=n(ce),re=n(ie),de=a(ie,2),ye=n(de),ve=a(de,2),le=n(ve),he=a(ce,2),te=n(he),be=a(n(te),2),$e=n(be),Ie=a(te,2);{var je=ue=>{var me=cs(),Se=a(n(me),2),Ce=n(Se);M(()=>S(Ce,t(T).manufacturer)),g(ue,me)};B(Ie,ue=>{t(T).manufacturer&&ue(je)})}var Me=a(Ie,2),x=a(n(Me),2),V=n(x),O=a(Me,2),pe=a(n(O),2),we=n(pe),qe=a(O,2);{var Oe=ue=>{var me=ds(),Se=a(n(me),2),Ce=n(Se);M((Re,tt)=>S(Ce,`📍 ${Re??""}, ${tt??""}`),[()=>t(T).latitude.toFixed(6),()=>t(T).longitude.toFixed(6)]),g(ue,me)};B(qe,ue=>{t(T).latitude&&t(T).longitude&&ue(Oe)})}var He=a(qe,2),We=a(n(He),2),xe=n(We);M((ue,me,Se,Ce)=>{S(re,ue),S(ye,t(T).ssid||"Hidden"),S(le,t(T).type),S($e,t(T).mac),ke(x,1,`value signal ${me??""}`,"svelte-13sgnrt"),S(V,Se),S(we,`${t(T).channel??""} (${t(T).frequency??""} MHz)`),S(xe,Ce)},[()=>ae(t(T)),()=>Y(t(T).signal),()=>q(t(T).signal),()=>W(t(T).lastSeen)]),g(j,G)},$$slots:{default:!0}})}),g(I,Q)};B(h,I=>{t(y).length===0?I(U):I(J,!1)},L)}};B(m,h=>{t(b)?h(F):h(l,!1)})}var k=a(Z,2),P=n(k),R=n(P),se=a(P,2);{var ne=h=>{var L=us();g(h,L)},ee=h=>{var L=ps();g(h,L)};B(se,h=>{p()?h(ne):h(ee,!1)})}M(()=>S(R,`Total: ${t(y).length??""} devices`)),g(u,C),Be(),d()}const hs="modulepreload",ms=function(u){return"/wigle/"+u},At={},mt=function(e,s,d){let v=Promise.resolve();if(s&&s.length>0){let f=function(i){return Promise.all(i.map(b=>Promise.resolve(b).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");v=f(s.map(i=>{if(i=ms(i),i in At)return;At[i]=!0;const b=i.endsWith(".css"),w=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${w}`))return;const y=document.createElement("link");if(y.rel=b?"stylesheet":hs,b||(y.as="script"),y.crossOrigin="",y.href=i,c&&y.setAttribute("nonce",c),document.head.appendChild(y),b)return new Promise((H,q)=>{y.addEventListener("load",H),y.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${i}`)))})}))}function p(f){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=f,window.dispatchEvent(o),!o.defaultPrevented)throw f}return v.then(f=>{for(const o of f||[])o.status==="rejected"&&p(o.reason);return e().catch(p)})};function _s(){console.log("Heatmap toggle not yet implemented")}var bs=$('<div class="map-header svelte-3xtg3"><h3 class="svelte-3xtg3">Device Map</h3> <div class="map-controls svelte-3xtg3"><button class="control-btn svelte-3xtg3" title="Zoom in"><span>+</span></button> <button class="control-btn svelte-3xtg3" title="Zoom out"><span>−</span></button> <button class="control-btn svelte-3xtg3" title="Fit all devices"><span>⊡</span></button> <button class="control-btn svelte-3xtg3" title="Toggle heatmap"><span>🔥</span></button></div></div> <div class="map-container svelte-3xtg3"></div> <div class="map-legend svelte-3xtg3"><div class="legend-item svelte-3xtg3"><span class="legend-marker ap svelte-3xtg3">📡</span> <span>Access Points</span></div> <div class="legend-item svelte-3xtg3"><span class="legend-marker client svelte-3xtg3">📱</span> <span>Clients</span></div> <div class="legend-stats svelte-3xtg3"> </div></div>',1);function ys(u,e){Ke(e,!0);const[s,d]=yt(),v=()=>Je(bt,"$deviceList",s);let p=oe(e,"selectedDevice",3,null),f=oe(e,"center",19,()=>({lat:40.7128,lon:-74.006})),o=oe(e,"zoom",3,13),c,i,b,w=new Map;const y={AP:"#22c55e",Client:"#3b82f6",Unknown:"#6b7280"};et(async()=>{const A=await mt(()=>import("./leaflet-src-r9KgTLRM.js").then(m=>m.l),[]);await mt(()=>Promise.resolve({}),__vite__mapDeps([0])),i=A.map(c).setView([f().lat,f().lon],o()),A.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19}).addTo(i),b=A.layerGroup().addTo(i),H();const Z=bt.subscribe(()=>H());return()=>{Z()}}),Ft(()=>{i&&i.remove()});async function H(){if(!i||!b)return;const A=await mt(()=>import("./leaflet-src-r9KgTLRM.js").then(m=>m.l),[]),Z=v().filter(m=>m.latitude&&m.longitude);if(w.forEach((m,F)=>{Z.find(l=>l.mac===F)||(b.removeLayer(m),w.delete(F))}),Z.forEach(m=>{if(!m.latitude||!m.longitude)return;const F=w.get(m.mac);if(F)F.setLatLng([m.latitude,m.longitude]),F.setPopupContent(W(m));else{const l=q(m,A),k=A.marker([m.latitude,m.longitude],{icon:l}).bindPopup(W(m)).addTo(b);k.on("click",()=>{window.dispatchEvent(new CustomEvent("device-selected",{detail:m}))}),w.set(m.mac,k)}}),p()&&p().latitude&&p().longitude){const m=w.get(p().mac);m&&(m.openPopup(),i.setView([p().latitude,p().longitude],16))}}function q(A,Z){const m=y[A.type]||y.Unknown,F=A.type==="AP"?30:24,l=Math.max(0,Math.min(100,(A.signal+100)*2));return Z.divIcon({className:"device-marker",html:`
        <div class="marker-container" style="background-color: ${m};">
          <div class="signal-indicator" style="width: ${l}%;"></div>
          <span class="device-type-icon">${A.type==="AP"?"📡":"📱"}</span>
        </div>
      `,iconSize:[F,F],iconAnchor:[F/2,F/2]})}function W(A){const m=Date.now()-A.lastSeen,F=m<6e4?"Just now":m<36e5?`${Math.floor(m/6e4)}m ago`:`${Math.floor(m/36e5)}h ago`;return`
      <div class="device-popup">
        <h4>${A.ssid||"Hidden Network"}</h4>
        <div class="popup-info">
          <div><strong>MAC:</strong> ${A.mac}</div>
          <div><strong>Type:</strong> ${A.type}</div>
          <div><strong>Signal:</strong> ${A.signal} dBm</div>
          <div><strong>Channel:</strong> ${A.channel}</div>
          ${A.manufacturer?`<div><strong>Vendor:</strong> ${A.manufacturer}</div>`:""}
          <div><strong>Last seen:</strong> ${F}</div>
          ${A.latitude&&A.longitude?`<div><strong>Location:</strong> ${A.latitude.toFixed(6)}, ${A.longitude.toFixed(6)}</div>`:""}
        </div>
      </div>
    `}Fe(()=>{p()&&w.has(p().mac)&&H()});function Y(){i?.zoomIn()}function ae(){i?.zoomOut()}function C(){if(!i||!b)return;const A=b.getBounds();A.isValid()&&i.fitBounds(A,{padding:[50,50]})}De(u,{class:"map-view",children:(A,Z)=>{var m=bs(),F=Ee(m),l=a(n(F),2),k=n(l);k.__click=Y;var P=a(k,2);P.__click=ae;var R=a(P,2);R.__click=C;var se=a(R,2);se.__click=[_s];var ne=a(F,2);Dt(ne,U=>c=U,()=>c);var ee=a(ne,2),h=a(n(ee),4),L=n(h);M(U=>S(L,`${U??""} devices on map`),[()=>v().filter(U=>U.latitude&&U.longitude).length]),g(A,m)},$$slots:{default:!0}}),Be(),d()}Pe(["click"]);var $s=$('<div class="loading svelte-ip2sb9">Loading configuration...</div>'),ws=$("<option> </option>"),ks=$("<option> </option>"),xs=$('<div class="status-row svelte-ip2sb9"><span>Errors:</span> <span class="status-value error svelte-ip2sb9"> </span></div>'),Ss=$('<div class="status-row svelte-ip2sb9"><span>Server:</span> <span class="status-value svelte-ip2sb9"> </span></div> <div class="status-row svelte-ip2sb9"><span>Messages sent:</span> <span class="status-value svelte-ip2sb9"> </span></div> <!>',1),Cs=$('<div><h4 class="svelte-ip2sb9">Server Status</h4> <div class="status-info svelte-ip2sb9"><div class="status-row svelte-ip2sb9"><span>Connection:</span> <span class="status-value svelte-ip2sb9"> </span></div> <!></div></div>'),As=$('<div class="message error svelte-ip2sb9"> </div>'),Ts=$('<div class="message success svelte-ip2sb9"> </div>'),Ds=$('<form class="svelte-ip2sb9"><div class="form-section svelte-ip2sb9"><h4 class="svelte-ip2sb9">Connection Settings</h4> <div class="form-group svelte-ip2sb9"><label for="server" class="svelte-ip2sb9">TAK Server Address</label> <input id="server" type="text" placeholder="192.168.1.100 or tak.example.com" required class="svelte-ip2sb9"/></div> <div class="form-group svelte-ip2sb9"><label for="port" class="svelte-ip2sb9">Port</label> <input id="port" type="number" min="1" max="65535" required class="svelte-ip2sb9"/></div></div> <div class="form-section svelte-ip2sb9"><h4 class="svelte-ip2sb9">Identity Settings</h4> <div class="form-group svelte-ip2sb9"><label for="callsign" class="svelte-ip2sb9">Callsign</label> <input id="callsign" type="text" placeholder="STINKY-1" required class="svelte-ip2sb9"/></div> <div class="form-group svelte-ip2sb9"><label for="team" class="svelte-ip2sb9">Team Color</label> <select id="team" class="svelte-ip2sb9"></select></div> <div class="form-group svelte-ip2sb9"><label for="role" class="svelte-ip2sb9">Role</label> <select id="role" class="svelte-ip2sb9"></select></div></div> <div class="form-section svelte-ip2sb9"><h4 class="svelte-ip2sb9">Sensor Settings</h4> <div class="form-group svelte-ip2sb9"><label for="antenna" class="svelte-ip2sb9">Antenna Height (meters)</label> <input id="antenna" type="number" min="0" max="100" step="0.1" class="svelte-ip2sb9"/> <span class="help-text svelte-ip2sb9">Height of antenna above ground</span></div> <div class="form-group svelte-ip2sb9"><label for="interval" class="svelte-ip2sb9">Scan Interval (seconds)</label> <input id="interval" type="number" min="5" max="300" class="svelte-ip2sb9"/> <span class="help-text svelte-ip2sb9">How often to send updates</span></div></div> <!> <!> <!> <div class="form-actions svelte-ip2sb9"><!> <!> <!></div></form>'),Es=$('<h3 class="svelte-ip2sb9">TAK Server Configuration</h3> <!>',1);function Ps(u,e){Ke(e,!0);let s,d=z(!1),v=z(!1),p=z(!1),f=z(null),o=z(null),c=z(null),i=z(rt({takServer:"",takPort:6969,callsign:"",team:"Yellow",role:"Team Member",antennaHeight:1.5,scanInterval:30}));const b=["White","Yellow","Orange","Magenta","Red","Maroon","Purple","Dark Blue","Blue","Cyan","Teal","Green","Dark Green","Brown"],w=["Team Member","Team Lead","HQ","Sniper","Medic","Forward Observer","RTO","K9","Airsoft","Sticky","JTAC","Engineer","Recon","Security"];et(async()=>{s=new ft,await y(),await q()});async function y(){r(d,!0),r(f,null);try{const C=await s.getTAKConfig();C.data&&r(i,C.data,!0)}catch(C){r(f,"Failed to load TAK configuration"),console.error(C)}finally{r(d,!1)}}async function H(){r(v,!0),r(f,null),r(o,null);try{const C=await s.updateTAKConfig(t(i));C.data&&(r(i,C.data,!0),r(o,"Configuration saved successfully"),e.onConfigSaved?.(C.data),await q())}catch(C){r(f,"Failed to save configuration"),console.error(C)}finally{r(v,!1)}}async function q(){try{const C=await s.getTAKStatus();C.data&&r(c,C.data,!0)}catch(C){console.error("Failed to check server status:",C)}}async function W(){r(p,!0),r(f,null),r(o,null);try{await H(),(await s.connectTAK()).data?.connected?(r(o,"Successfully connected to TAK server"),await q()):r(f,"Failed to connect to TAK server")}catch(C){r(f,"Connection test failed"),console.error(C)}finally{r(p,!1)}}async function Y(){try{await s.disconnectTAK(),await q(),r(o,"Disconnected from TAK server")}catch(C){r(f,"Failed to disconnect"),console.error(C)}}function ae(){return t(i).takServer?t(i).callsign?t(i).takPort<1||t(i).takPort>65535?(r(f,"Port must be between 1 and 65535"),!1):!0:(r(f,"Callsign is required"),!1):(r(f,"TAK server address is required"),!1)}Fe(()=>{if(t(o)){const C=setTimeout(()=>r(o,null),5e3);return()=>clearTimeout(C)}}),Fe(()=>{if(t(f)){const C=setTimeout(()=>r(f,null),5e3);return()=>clearTimeout(C)}}),De(u,{class:"tak-config-form",children:(C,A)=>{var Z=Es(),m=a(Ee(Z),2);{var F=k=>{var P=$s();g(k,P)},l=k=>{var P=Ds(),R=n(P),se=a(n(R),2),ne=a(n(se),2),ee=a(se,2),h=a(n(ee),2),L=a(R,2),U=a(n(L),2),J=a(n(U),2),I=a(U,2),Q=a(n(I),2);Le(Q,21,()=>b,nt,(x,V)=>{var O=ws(),pe={},we=n(O);M(()=>{pe!==(pe=t(V))&&(O.value=(O.__value=t(V))??""),S(we,t(V))}),g(x,O)});var D=a(I,2),E=a(n(D),2);Le(E,21,()=>w,nt,(x,V)=>{var O=ks(),pe={},we=n(O);M(()=>{pe!==(pe=t(V))&&(O.value=(O.__value=t(V))??""),S(we,t(V))}),g(x,O)});var T=a(L,2),j=a(n(T),2),N=a(n(j),2),G=a(j,2),ce=a(n(G),2),ie=a(T,2);{var re=x=>{var V=Cs();let O;var pe=a(n(V),2),we=n(pe),qe=a(n(we),2),Oe=n(qe),He=a(we,2);{var We=xe=>{var ue=Ss(),me=Ee(ue),Se=a(n(me),2),Ce=n(Se),Re=a(me,2),tt=a(n(Re),2),it=n(tt),gt=a(Re,2);{var ht=Ne=>{var lt=xs(),_=a(n(lt),2),K=n(_);M(()=>S(K,t(c).errors)),g(Ne,lt)};B(gt,Ne=>{t(c).errors>0&&Ne(ht)})}M(()=>{S(Ce,`${t(c).server??""}:${t(c).port??""}`),S(it,t(c).messagesSent)}),g(xe,ue)};B(He,xe=>{t(c).connected&&xe(We)})}M(xe=>{O=ke(V,1,"server-status svelte-ip2sb9",null,O,xe),S(Oe,t(c).connected?"🟢 Connected":"🔴 Disconnected")},[()=>({connected:t(c).connected})]),g(x,V)};B(ie,x=>{t(c)&&x(re)})}var de=a(ie,2);{var ye=x=>{var V=As(),O=n(V);M(()=>S(O,t(f))),g(x,V)};B(de,x=>{t(f)&&x(ye)})}var ve=a(de,2);{var le=x=>{var V=Ts(),O=n(V);M(()=>S(O,t(o))),g(x,V)};B(ve,x=>{t(o)&&x(le)})}var he=a(ve,2),te=n(he);const be=ze(()=>t(v)||t(p));ge(te,{type:"submit",variant:"primary",get disabled(){return t(be)},children:(x,V)=>{var O=fe();M(()=>S(O,t(v)?"Saving...":"Save Configuration")),g(x,O)},$$slots:{default:!0}});var $e=a(te,2);const Ie=ze(()=>t(v)||t(p)||!ae());ge($e,{type:"button",variant:"secondary",onclick:W,get disabled(){return t(Ie)},children:(x,V)=>{var O=fe();M(()=>S(O,t(p)?"Testing...":"Test Connection")),g(x,O)},$$slots:{default:!0}});var je=a($e,2);{var Me=x=>{ge(x,{type:"button",variant:"danger",onclick:Y,children:(V,O)=>{var pe=fe("Disconnect");g(V,pe)},$$slots:{default:!0}})};B(je,x=>{t(c)?.connected&&x(Me)})}Et("submit",P,x=>{x.preventDefault(),H()}),_e(ne,()=>t(i).takServer,x=>t(i).takServer=x),_e(h,()=>t(i).takPort,x=>t(i).takPort=x),_e(J,()=>t(i).callsign,x=>t(i).callsign=x),Ye(Q,()=>t(i).team,x=>t(i).team=x),Ye(E,()=>t(i).role,x=>t(i).role=x),_e(N,()=>t(i).antennaHeight,x=>t(i).antennaHeight=x),_e(ce,()=>t(i).scanInterval,x=>t(i).scanInterval=x),g(k,P)};B(m,k=>{t(d)?k(F):k(l,!1)})}g(C,Z)},$$slots:{default:!0}}),Be()}function Is(u,e,s){const v=u.target.files?.[0];if(v){if(!v.name.endsWith(".csv")&&!v.name.endsWith(".wiglecsv")){r(e,"Please select a valid WigleCSV file"),r(s,null);return}r(s,v,!0),r(e,null)}}var js=$('<div class="file-info svelte-1e45l3p"><span class="file-name svelte-1e45l3p"> </span> <span class="file-size svelte-1e45l3p"> </span></div>'),Ms=$('<div class="progress-bar svelte-1e45l3p"><div class="progress-fill svelte-1e45l3p"></div></div>'),Rs=$(`<h3 class="svelte-1e45l3p">Import WigleCSV</h3> <div class="file-input-wrapper svelte-1e45l3p"><input type="file" accept=".csv,.wiglecsv" class="file-input svelte-1e45l3p" id="wigle-file-input"/> <label for="wigle-file-input" class="file-label svelte-1e45l3p"><span class="file-icon svelte-1e45l3p">📁</span> <span class="file-text svelte-1e45l3p"> </span></label></div> <!> <!> <!> <div class="help-text svelte-1e45l3p">Import WiFi scan data from Kismet's WigleCSV export format.
      The file should contain MAC addresses, SSIDs, signal strength, and GPS coordinates.</div>`,1),Ls=$('<h3 class="svelte-1e45l3p">Export Data</h3> <div class="export-group svelte-1e45l3p"><h4 class="svelte-1e45l3p">Export Devices</h4> <div class="export-options svelte-1e45l3p"><select class="format-select svelte-1e45l3p"><option>CSV Format</option><option>JSON Format</option><option>KML (Google Earth)</option></select> <!></div></div> <div class="export-group svelte-1e45l3p"><h4 class="svelte-1e45l3p">Export TAK Messages</h4> <div class="export-options svelte-1e45l3p"><select class="format-select svelte-1e45l3p"><option>XML Format</option><option>JSON Format</option></select> <!></div></div>',1),zs=$('<div class="message error svelte-1e45l3p"> </div>'),Fs=$('<div class="message success svelte-1e45l3p"> </div>'),Ks=$('<div class="file-manager svelte-1e45l3p"><!> <!> <!> <!></div>');function Bs(u,e){Ke(e,!0);let s=new ft,d,v=z(null),p=z(!1),f=z(!1),o=z(null),c=z(null),i=z(0),b=z("csv"),w=z("xml");async function y(){if(!t(v)){r(o,"Please select a file to import");return}r(p,!0),r(o,null),r(c,null),r(i,0);try{const l=setInterval(()=>{r(i,Math.min(t(i)+10,90),!0)},200),k=await s.importWigleCSV(t(v));if(clearInterval(l),r(i,100),k.data){const{imported:P,skipped:R,errors:se}=k.data;se.length>0?r(o,`Import completed with errors: ${se.join(", ")}`):r(c,`Successfully imported ${P} devices (${R} skipped)`),e.onImportComplete?.({imported:P,skipped:R}),r(v,null),d&&(d.value="")}}catch(l){r(o,"Failed to import file"),console.error(l)}finally{r(p,!1),r(i,0)}}async function H(){r(f,!0),r(o,null),r(c,null);try{const l=await s.exportDevices(t(b));if(l.data){const k=l.data,P=URL.createObjectURL(k),R=document.createElement("a");R.href=P,R.download=`wigle_devices_${new Date().toISOString()}.${t(b)}`,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(P),r(c,`Devices exported as ${t(b).toUpperCase()}`)}}catch(l){r(o,"Failed to export devices"),console.error(l)}finally{r(f,!1)}}async function q(){r(f,!0),r(o,null),r(c,null);try{const l=await s.exportTAKMessages(t(w));if(l.data){const k=l.data,P=URL.createObjectURL(k),R=document.createElement("a");R.href=P,R.download=`tak_messages_${new Date().toISOString()}.${t(w)}`,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(P),r(c,`TAK messages exported as ${t(w).toUpperCase()}`)}}catch(l){r(o,"Failed to export TAK messages"),console.error(l)}finally{r(f,!1)}}function W(l){return l<1024?l+" B":l<1024*1024?(l/1024).toFixed(1)+" KB":(l/(1024*1024)).toFixed(1)+" MB"}Fe(()=>{if(t(c)){const l=setTimeout(()=>r(c,null),5e3);return()=>clearTimeout(l)}}),Fe(()=>{if(t(o)){const l=setTimeout(()=>r(o,null),5e3);return()=>clearTimeout(l)}});var Y=Ks(),ae=n(Y);De(ae,{class:"import-section",children:(l,k)=>{var P=Rs(),R=a(Ee(P),2),se=n(R);se.__change=[Is,o,v],Dt(se,E=>d=E,()=>d);var ne=a(se,2),ee=a(n(ne),2),h=n(ee),L=a(R,2);{var U=E=>{var T=js(),j=n(T),N=n(j),G=a(j,2),ce=n(G);M(ie=>{S(N,t(v).name),S(ce,ie)},[()=>W(t(v).size)]),g(E,T)};B(L,E=>{t(v)&&E(U)})}var J=a(L,2);{var I=E=>{var T=Ms(),j=n(T);M(()=>Kt(j,`width: ${t(i)??""}%`)),g(E,T)};B(J,E=>{t(p)&&t(i)>0&&E(I)})}var Q=a(J,2);const D=ze(()=>!t(v)||t(p));ge(Q,{variant:"primary",onclick:y,get disabled(){return t(D)},class:"import-btn",children:(E,T)=>{var j=fe();M(()=>S(j,t(p)?`Importing... ${t(i)}%`:"Import File")),g(E,j)},$$slots:{default:!0}}),M(()=>S(h,t(v)?t(v).name:"Choose WigleCSV file...")),g(l,P)},$$slots:{default:!0}});var C=a(ae,2);De(C,{class:"export-section",children:(l,k)=>{var P=Ls(),R=a(Ee(P),2),se=a(n(R),2),ne=n(se),ee=n(ne);ee.value=ee.__value="csv";var h=a(ee);h.value=h.__value="json";var L=a(h);L.value=L.__value="kml";var U=a(ne,2);ge(U,{variant:"secondary",onclick:H,get disabled(){return t(f)},children:(j,N)=>{var G=fe();M(()=>S(G,t(f)?"Exporting...":"Export Devices")),g(j,G)},$$slots:{default:!0}});var J=a(R,2),I=a(n(J),2),Q=n(I),D=n(Q);D.value=D.__value="xml";var E=a(D);E.value=E.__value="json";var T=a(Q,2);ge(T,{variant:"secondary",onclick:q,get disabled(){return t(f)},children:(j,N)=>{var G=fe();M(()=>S(G,t(f)?"Exporting...":"Export TAK Messages")),g(j,G)},$$slots:{default:!0}}),Ye(ne,()=>t(b),j=>r(b,j)),Ye(Q,()=>t(w),j=>r(w,j)),g(l,P)},$$slots:{default:!0}});var A=a(C,2);{var Z=l=>{var k=zs(),P=n(k);M(()=>S(P,t(o))),g(l,k)};B(A,l=>{t(o)&&l(Z)})}var m=a(A,2);{var F=l=>{var k=Fs(),P=n(k);M(()=>S(P,t(c))),g(l,k)};B(m,l=>{t(c)&&l(F)})}g(u,Y),Be()}Pe(["change"]);var qs=$('<div class="loading svelte-10bjf5a">Loading settings...</div>'),Os=(u,e,s)=>e(t(s)),Hs=$('<label class="channel-checkbox svelte-10bjf5a"><input type="checkbox" class="svelte-10bjf5a"/> <span> </span></label>'),Ws=(u,e,s)=>e(t(s)),Ns=$('<label class="channel-checkbox svelte-10bjf5a"><input type="checkbox" class="svelte-10bjf5a"/> <span> </span></label>'),Us=$('<div class="empty-list svelte-10bjf5a">No BSSIDs ignored</div>'),Gs=(u,e,s)=>e(t(s)),Vs=$('<div class="bssid-item svelte-10bjf5a"><span class="bssid-mac svelte-10bjf5a"> </span> <button type="button" class="remove-btn svelte-10bjf5a">✕</button></div>'),Xs=$('<div class="message error svelte-10bjf5a"> </div>'),Js=$('<div class="message success svelte-10bjf5a"> </div>'),Qs=$('<form class="svelte-10bjf5a"><div class="settings-section svelte-10bjf5a"><h4 class="svelte-10bjf5a">Detection Settings</h4> <div class="setting-group svelte-10bjf5a"><label for="interval" class="svelte-10bjf5a">Scan Interval</label> <div class="slider-group svelte-10bjf5a"><input id="interval" type="range" min="5" max="300" step="5" class="svelte-10bjf5a"/> <span class="slider-value svelte-10bjf5a"> </span></div> <span class="help-text svelte-10bjf5a">How often to perform WiFi scans</span></div> <div class="setting-group svelte-10bjf5a"><label for="threshold" class="svelte-10bjf5a">Signal Threshold</label> <div class="slider-group svelte-10bjf5a"><input id="threshold" type="range" min="-100" max="-30" class="svelte-10bjf5a"/> <span class="slider-value svelte-10bjf5a"> </span></div> <span class="help-text svelte-10bjf5a">Minimum signal strength to track devices</span></div> <div class="setting-group svelte-10bjf5a"><label for="maxage" class="svelte-10bjf5a">Device Timeout</label> <div class="slider-group svelte-10bjf5a"><input id="maxage" type="range" min="60" max="7200" step="60" class="svelte-10bjf5a"/> <span class="slider-value svelte-10bjf5a"> </span></div> <span class="help-text svelte-10bjf5a">Remove devices not seen for this duration</span></div></div> <div class="settings-section svelte-10bjf5a"><h4 class="svelte-10bjf5a">Channel Selection</h4> <div class="channel-presets svelte-10bjf5a"><!> <!> <!></div> <div class="channel-grid svelte-10bjf5a"><div class="channel-band"><h5 class="svelte-10bjf5a">2.4GHz Channels</h5> <div class="channel-list svelte-10bjf5a"></div></div> <div class="channel-band"><h5 class="svelte-10bjf5a">5GHz Channels</h5> <div class="channel-list svelte-10bjf5a"></div></div></div> <div class="custom-channel svelte-10bjf5a"><input type="number" placeholder="Custom channel" min="1" max="165" class="channel-input svelte-10bjf5a"/> <!></div> <div class="selected-channels svelte-10bjf5a"> </div></div> <div class="settings-section svelte-10bjf5a"><h4 class="svelte-10bjf5a">Ignored BSSIDs</h4> <div class="bssid-input svelte-10bjf5a"><input type="text" placeholder="AA:BB:CC:DD:EE:FF" class="bssid-field svelte-10bjf5a"/> <!></div> <div class="bssid-list svelte-10bjf5a"><!></div> <span class="help-text svelte-10bjf5a">Add MAC addresses of devices to ignore (e.g., your own access points)</span></div> <!> <!> <div class="form-actions svelte-10bjf5a"><!> <!></div></form>'),Ys=$('<h3 class="svelte-10bjf5a">Scan Filter Settings</h3> <!>',1),Zs=$('<div class="filter-manager svelte-10bjf5a"><!></div>');function ea(u,e){Ke(e,!0);let s,d=z(!1),v=z(!1),p=z(null),f=z(null),o=z(rt({scanInterval:30,signalThreshold:-90,maxAge:3600,channels:[],ignoreBSSIDs:[]})),c=z(""),i=z(rt(new Set)),b=z("");const w={"2.4GHz":[1,6,11],"5GHz":[36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140,144,149,153,157,161,165]};et(async()=>{s=new ft,await y()});async function y(){r(d,!0),r(p,null);try{const l=await s.getScanSettings();l.data&&(r(o,l.data,!0),r(i,new Set(t(o).channels),!0))}catch(l){r(p,"Failed to load scan settings"),console.error(l)}finally{r(d,!1)}}async function H(){r(v,!0),r(p,null),r(f,null),t(o).channels=Array.from(t(i)).sort((l,k)=>l-k);try{const l=await s.updateScanSettings(t(o));l.data&&(r(o,l.data,!0),r(f,"Settings saved successfully"),e.onSettingsChanged?.(l.data))}catch(l){r(p,"Failed to save settings"),console.error(l)}finally{r(v,!1)}}function q(){if(!t(c))return;if(!/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/.test(t(c))){r(p,"Invalid MAC address format (use XX:XX:XX:XX:XX:XX)");return}const k=t(c).toUpperCase();t(o).ignoreBSSIDs.includes(k)||(t(o).ignoreBSSIDs=[...t(o).ignoreBSSIDs,k],r(c,""),r(p,null))}function W(l){t(o).ignoreBSSIDs=t(o).ignoreBSSIDs.filter(k=>k!==l)}function Y(l){t(i).has(l)?t(i).delete(l):t(i).add(l),r(i,new Set(t(i)),!0)}function ae(l){w[l].forEach(k=>t(i).add(k)),r(i,new Set(t(i)),!0)}function C(){t(i).clear(),r(i,new Set(t(i)),!0)}function A(){const l=parseInt(t(b));!isNaN(l)&&l>=1&&l<=165?(t(i).add(l),r(i,new Set(t(i)),!0),r(b,"")):r(p,"Invalid channel number (1-165)")}function Z(l){return l<60?`${l} seconds`:l<3600?`${Math.floor(l/60)} minutes`:l<86400?`${Math.floor(l/3600)} hours`:`${Math.floor(l/86400)} days`}Fe(()=>{if(t(f)){const l=setTimeout(()=>r(f,null),5e3);return()=>clearTimeout(l)}}),Fe(()=>{if(t(p)){const l=setTimeout(()=>r(p,null),5e3);return()=>clearTimeout(l)}});var m=Zs(),F=n(m);De(F,{children:(l,k)=>{var P=Ys(),R=a(Ee(P),2);{var se=ee=>{var h=qs();g(ee,h)},ne=ee=>{var h=Qs(),L=n(h),U=a(n(L),2),J=a(n(U),2),I=n(J),Q=a(I,2),D=n(Q),E=a(U,2),T=a(n(E),2),j=n(T),N=a(j,2),G=n(N),ce=a(E,2),ie=a(n(ce),2),re=n(ie),de=a(re,2),ye=n(de),ve=a(L,2),le=a(n(ve),2),he=n(le);ge(he,{type:"button",variant:"secondary",size:"small",onclick:()=>ae("2.4GHz"),children:(_,K)=>{var X=fe("Select 2.4GHz");g(_,X)},$$slots:{default:!0}});var te=a(he,2);ge(te,{type:"button",variant:"secondary",size:"small",onclick:()=>ae("5GHz"),children:(_,K)=>{var X=fe("Select 5GHz");g(_,X)},$$slots:{default:!0}});var be=a(te,2);ge(be,{type:"button",variant:"secondary",size:"small",onclick:C,children:(_,K)=>{var X=fe("Clear All");g(_,X)},$$slots:{default:!0}});var $e=a(le,2),Ie=n($e),je=a(n(Ie),2);Le(je,21,()=>w["2.4GHz"],nt,(_,K)=>{var X=Hs(),Ae=n(X);Ae.__change=[Os,Y,K];var Ue=a(Ae,2),Ge=n(Ue);M(Ve=>{kt(Ae,Ve),S(Ge,t(K))},[()=>t(i).has(t(K))]),g(_,X)});var Me=a(Ie,2),x=a(n(Me),2);Le(x,21,()=>w["5GHz"],nt,(_,K)=>{var X=Ns(),Ae=n(X);Ae.__change=[Ws,Y,K];var Ue=a(Ae,2),Ge=n(Ue);M(Ve=>{kt(Ae,Ve),S(Ge,t(K))},[()=>t(i).has(t(K))]),g(_,X)});var V=a($e,2),O=n(V),pe=a(O,2);ge(pe,{type:"button",variant:"secondary",size:"small",onclick:A,children:(_,K)=>{var X=fe("Add Channel");g(_,X)},$$slots:{default:!0}});var we=a(V,2),qe=n(we),Oe=a(ve,2),He=a(n(Oe),2),We=n(He),xe=a(We,2);ge(xe,{type:"button",variant:"secondary",size:"small",onclick:q,children:(_,K)=>{var X=fe("Add BSSID");g(_,X)},$$slots:{default:!0}});var ue=a(He,2),me=n(ue);{var Se=_=>{var K=Us();g(_,K)},Ce=_=>{var K=Tt(),X=Ee(K);Le(X,17,()=>t(o).ignoreBSSIDs,nt,(Ae,Ue)=>{var Ge=Vs(),Ve=n(Ge),Mt=n(Ve),Rt=a(Ve,2);Rt.__click=[Gs,W,Ue],M(()=>S(Mt,t(Ue))),g(Ae,Ge)}),g(_,K)};B(me,_=>{t(o).ignoreBSSIDs.length===0?_(Se):_(Ce,!1)})}var Re=a(Oe,2);{var tt=_=>{var K=Xs(),X=n(K);M(()=>S(X,t(p))),g(_,K)};B(Re,_=>{t(p)&&_(tt)})}var it=a(Re,2);{var gt=_=>{var K=Js(),X=n(K);M(()=>S(X,t(f))),g(_,K)};B(it,_=>{t(f)&&_(gt)})}var ht=a(it,2),Ne=n(ht);ge(Ne,{type:"submit",variant:"primary",get disabled(){return t(v)},children:(_,K)=>{var X=fe();M(()=>S(X,t(v)?"Saving...":"Save Settings")),g(_,X)},$$slots:{default:!0}});var lt=a(Ne,2);ge(lt,{type:"button",variant:"secondary",onclick:y,children:(_,K)=>{var X=fe("Reset");g(_,X)},$$slots:{default:!0}}),M((_,K)=>{S(D,`${t(o).scanInterval??""}s`),S(G,`${t(o).signalThreshold??""} dBm`),S(ye,_),S(qe,`Selected: ${K??""}`)},[()=>Z(t(o).maxAge),()=>t(i).size===0?"All channels":Array.from(t(i)).sort((_,K)=>_-K).join(", ")]),Et("submit",h,_=>{_.preventDefault(),H()}),_e(I,()=>t(o).scanInterval,_=>t(o).scanInterval=_),_e(j,()=>t(o).signalThreshold,_=>t(o).signalThreshold=_),_e(re,()=>t(o).maxAge,_=>t(o).maxAge=_),_e(O,()=>t(b),_=>r(b,_)),_e(We,()=>t(c),_=>r(c,_)),g(ee,h)};B(R,ee=>{t(d)?ee(se):ee(ne,!1)})}g(l,P)},$$slots:{default:!0}}),g(u,m),Be()}Pe(["change","click"]);var ta=(u,e,s)=>e(t(s).id),sa=$('<div role="alert"><span class="notification-icon svelte-yegmcu"> </span> <span class="notification-message svelte-yegmcu"> </span> <button class="notification-close svelte-yegmcu" aria-label="Close notification">✕</button></div>'),aa=$('<div class="notifications-container svelte-yegmcu"></div>');function na(u,e){Ke(e,!0);let s=z(rt([]));function d(o){const c=Date.now().toString(),i={...o,id:c};r(s,[...t(s),i],!0),o.duration!==0&&setTimeout(()=>{v(c)},o.duration||5e3)}function v(o){r(s,t(s).filter(c=>c.id!==o),!0)}et(()=>(window.wigleNotifications={success:(o,c)=>d({type:"success",message:o,duration:c}),error:(o,c)=>d({type:"error",message:o,duration:c}),warning:(o,c)=>d({type:"warning",message:o,duration:c}),info:(o,c)=>d({type:"info",message:o,duration:c})},()=>{delete window.wigleNotifications}));function p(o){switch(o){case"success":return"✓";case"error":return"✕";case"warning":return"⚠";case"info":return"ℹ"}}var f=aa();Le(f,21,()=>t(s),o=>o.id,(o,c)=>{var i=sa(),b=n(i),w=n(b),y=a(b,2),H=n(y),q=a(y,2);q.__click=[ta,v,c],M(W=>{ke(i,1,`notification notification-${t(c).type??""}`,"svelte-yegmcu"),S(w,W),S(H,t(c).message)},[()=>p(t(c).type)]),g(o,i)}),g(u,f),Be()}Pe(["click"]);var ra=$('<span class="connection-status connected svelte-i4ozb1">🟢 Connected</span>'),oa=$('<span class="connection-status error svelte-i4ozb1">🔴 Error</span>'),ia=$('<span class="connection-status disconnected svelte-i4ozb1">🔴 Disconnected</span>'),la=(u,e)=>r(e,"devices"),ca=(u,e)=>r(e,"map"),da=(u,e)=>r(e,"tak"),va=(u,e)=>r(e,"filters"),ua=(u,e)=>r(e,"files"),pa=$('<main class="wigle-app svelte-i4ozb1"><!> <header class="app-header svelte-i4ozb1"><h1 class="svelte-i4ozb1">WigleToTAK</h1> <div class="header-info svelte-i4ozb1"><span class="device-count svelte-i4ozb1"> </span> <!></div></header> <nav class="tab-navigation svelte-i4ozb1"><button>Devices</button> <button>Map</button> <button>TAK Config</button> <button>Filters</button> <button>Import/Export</button></nav> <div class="app-content svelte-i4ozb1"><!></div></main>');function fa(u,e){Ke(e,!0);const[s,d]=yt(),v=()=>Je(ns,"$deviceCount",s),p=()=>Je(jt,"$isConnected",s),f=()=>Je(as,"$connectionError",s);let o=z(null),c=z("devices");et(()=>(es(),window.addEventListener("device-selected",i),()=>{ts(),window.removeEventListener("device-selected",i)}));function i(D){r(o,D.detail,!0),r(c,"devices")}function b(D){r(o,D,!0),D.latitude&&D.longitude&&r(c,"map")}function w(D){window.wigleNotifications?.success(`Successfully imported ${D.imported} devices (${D.skipped} skipped)`)}var y=pa(),H=n(y);na(H,{});var q=a(H,2),W=a(n(q),2),Y=n(W),ae=n(Y),C=a(Y,2);{var A=D=>{var E=ra();g(D,E)},Z=(D,E)=>{{var T=N=>{var G=oa();M(()=>_t(G,"title",f().message)),g(N,G)},j=N=>{var G=ia();g(N,G)};B(D,N=>{f()?N(T):N(j,!1)},E)}};B(C,D=>{p()?D(A):D(Z,!1)})}var m=a(q,2),F=n(m);let l;F.__click=[la,c];var k=a(F,2);let P;k.__click=[ca,c];var R=a(k,2);let se;R.__click=[da,c];var ne=a(R,2);let ee;ne.__click=[va,c];var h=a(ne,2);let L;h.__click=[ua,c];var U=a(m,2),J=n(U);{var I=D=>{at(D,{cols:1,children:(E,T)=>{st(E,{title:"WiFi Devices",resizable:!0,children:(j,N)=>{gs(j,{onDeviceSelect:b})},$$slots:{default:!0}})},$$slots:{default:!0}})},Q=(D,E)=>{{var T=N=>{at(N,{cols:1,children:(G,ce)=>{st(G,{title:"Device Map",resizable:!0,children:(ie,re)=>{ys(ie,{get selectedDevice(){return t(o)}})},$$slots:{default:!0}})},$$slots:{default:!0}})},j=(N,G)=>{{var ce=re=>{at(re,{cols:1,children:(de,ye)=>{st(de,{title:"TAK Server Configuration",children:(ve,le)=>{Ps(ve,{})},$$slots:{default:!0}})},$$slots:{default:!0}})},ie=(re,de)=>{{var ye=le=>{at(le,{cols:1,children:(he,te)=>{st(he,{title:"Scan Filters",children:(be,$e)=>{ea(be,{})},$$slots:{default:!0}})},$$slots:{default:!0}})},ve=(le,he)=>{{var te=be=>{at(be,{cols:1,children:($e,Ie)=>{st($e,{title:"File Management",children:(je,Me)=>{Bs(je,{onImportComplete:w})},$$slots:{default:!0}})},$$slots:{default:!0}})};B(le,be=>{t(c)==="files"&&be(te)},he)}};B(re,le=>{t(c)==="filters"?le(ye):le(ve,!1)},de)}};B(N,re=>{t(c)==="tak"?re(ce):re(ie,!1)},G)}};B(D,N=>{t(c)==="map"?N(T):N(j,!1)},E)}};B(J,D=>{t(c)==="devices"?D(I):D(Q,!1)})}M((D,E,T,j,N)=>{S(ae,`📡 ${v()??""} devices`),l=ke(F,1,"tab-button svelte-i4ozb1",null,l,D),P=ke(k,1,"tab-button svelte-i4ozb1",null,P,E),se=ke(R,1,"tab-button svelte-i4ozb1",null,se,T),ee=ke(ne,1,"tab-button svelte-i4ozb1",null,ee,j),L=ke(h,1,"tab-button svelte-i4ozb1",null,L,N)},[()=>({active:t(c)==="devices"}),()=>({active:t(c)==="map"}),()=>({active:t(c)==="tak"}),()=>({active:t(c)==="filters"}),()=>({active:t(c)==="files"})]),g(u,y),Be(),d()}Pe(["click"]);new fa({target:document.getElementById("app")});
//# sourceMappingURL=main-DVXDxG5D.js.map
