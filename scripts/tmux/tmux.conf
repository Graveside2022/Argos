# Argos tmux Configuration
# Installed by: scripts/ops/setup-host.sh (section 24 — Zsh + Dotfiles)
# Theme: Lunaris dark dashboard (gold/amber accent on dark chrome)
# Plugins: TPM, tmux-resurrect, tmux-continuum

# ── General Settings ──
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:Tc"
set -g mouse on
set -g history-limit 50000
set -s escape-time 0
set -g focus-events on
set -g default-shell /bin/zsh

# ── Status bar position & refresh ──
set -g status-position bottom
set -g status-interval 5

# ── Status bar colors (Lunaris dark chrome) ──
set -g status-style 'bg=#12161c,fg=#9aa0a6'

# ── Left: session name with gold accent ──
set -g status-left-length 30
set -g status-left '#[bg=#d4a843,fg=#12161c,bold] #{session_name} #[bg=#12161c,fg=#d4a843,nobold] '

# ── Right: continuum status + time ──
set -g status-right-length 50
set -g status-right '#[fg=#5f6368]#{?client_prefix,#[fg=#d4a843]PREFIX ,}#[fg=#9aa0a6]%H:%M #[fg=#5f6368]| #[fg=#9aa0a6]%d-%b-%y '

# ── Window tabs ──
set -g window-status-format '#[fg=#5f6368] #I:#W '
set -g window-status-current-format '#[fg=#e8eaed,bold] #I:#W#F '
set -g window-status-separator ''

# ── Pane borders ──
set -g pane-border-style 'fg=#1e2228'
set -g pane-active-border-style 'fg=#d4a843'

# ── Message bar ──
set -g message-style 'bg=#1a1f27,fg=#e8eaed'
set -g message-command-style 'bg=#1a1f27,fg=#d4a843'

# ── Misc ──
set -g display-time 2000
set -g base-index 1
set -g pane-base-index 1
set -g renumber-windows on

# ── Key Bindings ──
# Prefix: Ctrl-b (default)
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# ── Plugins (managed by TPM) ──
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# ── Resurrect: save/restore session layout ──
set -g @resurrect-capture-pane-contents 'off'
set -g @resurrect-dir '~/.tmux/resurrect'
# Don't restore programs — keepalive-dev.sh handles Vite restart with OOM
# protection. Resurrect would launch Vite without the wrapper.
set -g @resurrect-processes 'false'

# ── Continuum: auto-save every 15 min, restore on tmux start ──
set -g @continuum-save-interval '15'
set -g @continuum-restore 'on'
# Boot persistence handled by custom tmux.service (scripts/tmux/tmux.service)
# @continuum-boot deliberately OFF — our service creates named sessions;
# continuum's boot feature would overwrite it with a generic single-session unit
set -g @continuum-boot 'off'

# Initialize TPM (keep as last line)
run '~/.tmux/plugins/tpm/tpm'
