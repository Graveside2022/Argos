# Data Model: UI Modernization to Tailwind CSS v4 + shadcn

**Feature**: 003-ui-modernization
**Date**: 2026-02-15

---

## Overview

This feature has no database schema changes. All entities are CSS/configuration artifacts that control the visual layer. No new tables, columns, or migrations are needed. SQLite (`rf_signals.db`) remains untouched.

---

## Entity 1: CSS Variable Token

**Definition**: A named design token in `src/app.css` that controls a visual property.

**Location**: `src/app.css` (`:root` and `.dark` blocks)

**Format**: Full `hsl()` wrapped values (e.g., `hsl(220 24% 7%)`) — complete CSS color values, not bare channels

**Categories**:

| Category                | Variables                                                                                                                                                                                                                                                                                                                                      | Count |
| ----------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----- |
| Core (shadcn standard)  | `--background`, `--foreground`, `--card`, `--card-foreground`, `--popover`, `--popover-foreground`, `--primary`, `--primary-foreground`, `--secondary`, `--secondary-foreground`, `--muted`, `--muted-foreground`, `--accent`, `--accent-foreground`, `--destructive`, `--destructive-foreground`, `--border`, `--input`, `--ring`, `--radius` | 20    |
| Chart                   | `--chart-1` through `--chart-6`                                                                                                                                                                                                                                                                                                                | 6     |
| Custom (Argos-specific) | `--success`, `--success-foreground`, `--warning`, `--warning-foreground`, `--info`, `--info-foreground`, `--text-muted`, `--signal-critical`, `--signal-strong`, `--signal-good`, `--signal-fair`, `--signal-weak`, `--feature-rf`, `--feature-drone`, `--feature-radio`                                                                       | 15    |

**State Transitions**: None — static configuration.

**Validation Rules**:

- All values must be valid CSS color values wrapped in `hsl()`: H in [0, 360], S in [0%, 100%], L in [0%, 100%]
- No duplicate variable names between `:root` and `.dark` blocks (values differ, names match)
- Every variable referenced in `@theme` must exist in CSS variable blocks

---

## Entity 2: shadcn Component

**Definition**: A Svelte component source file generated by the shadcn CLI.

**Location**: `src/lib/components/ui/{component-name}/`

**Structure per component**:

```
src/lib/components/ui/alert-dialog/
├── index.ts          # Named exports
├── alert-dialog.svelte
├── alert-dialog-action.svelte
├── alert-dialog-cancel.svelte
├── alert-dialog-content.svelte
├── alert-dialog-description.svelte
├── alert-dialog-footer.svelte
├── alert-dialog-header.svelte
├── alert-dialog-overlay.svelte
├── alert-dialog-portal.svelte
└── alert-dialog-title.svelte
```

**Dependencies**: `bits-ui` (headless behavior), `cn()` utility from `$lib/utils`

**Validation Rules**:

- All components must use Argos dark theme colors (not default zinc/slate)
- Components must import `cn` from `$lib/utils`
- Components must use `tailwind-variants` or plain Tailwind classes (no inline styles)

---

## Entity 3: Configuration Artifact — components.json

**Definition**: shadcn CLI configuration file at project root.

**Fields**:

| Field                | Type    | Value                                     | Purpose                |
| -------------------- | ------- | ----------------------------------------- | ---------------------- |
| `$schema`            | string  | `"https://shadcn-svelte.com/schema.json"` | Validation             |
| `tailwind.css`       | string  | `"src/app.css"`                           | CSS entry point        |
| `tailwind.baseColor` | string  | `"zinc"`                                  | Base color palette     |
| `aliases.components` | string  | `"$lib/components"`                       | Component path         |
| `aliases.utils`      | string  | `"$lib/utils"`                            | Utility import path    |
| `aliases.ui`         | string  | `"$lib/components/ui"`                    | UI component path      |
| `aliases.hooks`      | string  | `"$lib/hooks"`                            | Hooks import path      |
| `aliases.lib`        | string  | `"$lib"`                                  | Lib import path        |
| `typescript`         | boolean | `true`                                    | Generate TS components |
| `registry`           | string  | `"https://shadcn-svelte.com/registry"`    | Component registry URL |

**Note (TW v4)**: No `style` field (new-york is the only/default style). No `tailwind.config` field (CSS-first config).

---

## Entity 4: Theme Color Bridge — resolveThemeColor()

**Definition**: Runtime utility function that converts CSS variable names to hex strings for APIs that cannot consume CSS variables directly (Leaflet, Canvas 2D).

**Location**: `src/lib/utils/theme-colors.ts`

**Interface**:

```typescript
/** Resolves a CSS custom property to its computed hex value.
 *  Returns fallback if SSR context (no DOM) or variable not found. */
export function resolveThemeColor(varName: string, fallback?: string): string;
```

**Validation Rules**:

- Must guard against SSR context (`typeof document !== 'undefined'`)
- Must return valid hex string (e.g., `#dc2626`)
- Must accept CSS variable name with or without `--` prefix
- Fallback defaults to `#000000` if not provided

---

## Relationships

```
components.json ──configures──► shadcn CLI ──generates──► shadcn Components
                                                              │
CSS Variable Tokens ──consumed-by──► shadcn Components        │
        │                                                      │
        └──consumed-by──► @theme block ──generates──► Tailwind Utilities
        │
        └──consumed-by──► resolveThemeColor() ──provides-hex──► Leaflet/Canvas APIs
```

---

## Files Affected (No Schema Migrations)

| File                                        | Action  | Description                                          |
| ------------------------------------------- | ------- | ---------------------------------------------------- |
| `src/app.css`                               | REWRITE | CSS variables, @import, @theme, @plugin, @layer base |
| `src/app.html`                              | SLIM    | 186→~15 lines, add `class="dark"`                    |
| `src/lib/styles/palantir-design-system.css` | MODIFY  | Remove dead + shadowing classes                      |
| `vite.config.ts`                            | MODIFY  | Add `@tailwindcss/vite` plugin                       |
| `components.json`                           | CREATE  | shadcn CLI config                                    |
| `src/lib/utils.ts`                          | CREATE  | cn() utility                                         |
| `src/lib/utils/theme-colors.ts`             | CREATE  | resolveThemeColor()                                  |
| `src/lib/components/ui/alert-dialog/`       | CREATE  | shadcn AlertDialog                                   |
| `tailwind.config.js`                        | DELETE  | Replaced by CSS-first config                         |
| `postcss.config.js` (symlink)               | DELETE  | Replaced by @tailwindcss/vite                        |
| `config/postcss.config.js` (target)         | DELETE  | Replaced by @tailwindcss/vite                        |
