---
phase: 016-code-expressiveness
task: Phase 14 complete, Phase 15 next
total_tasks: 86
completed_tasks: 42
status: between_phases
last_updated: 2026-02-24T13:14:36.679Z
---

<current_state>
Phase 14 (US11 — Logging & Cleanup) is fully complete and committed (14bc549).
All 3 tasks (T042, T043, T044) done. Build passes, 239/239 unit tests pass.
42 of 86 tasks complete (49%). Phases 1-14 are all finished.
</current_state>

<completed_work>

This session completed Phase 14:

- T042: Migrated ~175 logError/logInfo/logWarn/logDebug convenience wrapper calls to direct logger.error/info/warn/debug across 26 files. Removed all 4 convenience exports from logger.ts. Fixed kismet.service.test.ts mock to match new logger API shape.
- T043: Added dispose() cleanup methods to 4 setInterval instances: resource-manager.ts, gsm-monitor-service.ts, rate-limit-middleware.ts, logger.ts.
- T044: Fixed 7 unsafe (error as Error) casts + 4 additional unsafe casts using errMsg(), normalizeError(), ExecFileException type, hasSignal type guard, and typeof narrowing.

Prior sessions completed Phases 1-13 (T001-T041, T080-T084).
</completed_work>

<remaining_work>

44 tasks remain across 5 phases:

**Phase 8 — US8 Client-Side Libraries (9 tasks)**

- T018-T024: Data tables, virtual scrolling, form validation, svelte-query, Kismet store unification
- T078-T079: Client-side fetchJSON wrapper + migration of 37 fetch patterns
- NOTE: T018, T020, T022, T023 require user approval for npm install

**Phase 15 — US12 Oversized File Decomposition (13 tasks)**

- T045-T057: Decompose 13 files >300 LOC into smaller modules
- All tasks are [P] parallel — touch independent files
- Depends on Phases 11-14 being done (they are)

**Phase 16 — Cross-cutting Type Safety (5 tasks)**

- T058: globalThis typed declarations in app.d.ts
- T059: JSON.parse validation at trust boundaries
- T060: Fix swallowed errors in OverviewPanel.svelte
- T085: Typed interfaces for external API responses (~100 unsafe casts)
- T086: Resolve 4 eslint-disable directives

**Phase 18 — Route Handler Migration at Scale (10 tasks)**

- T068-T077: Migrate ~50 routes to createHandler() factory in 10 batches of 5

**Phase 17 — Final Verification (7 tasks)**

- T061-T067: Full test suite, build, LOC delta, SC verification, madge, bundle size, report
- Must be last — depends on all other phases
  </remaining_work>

<decisions_made>

- Migrated ALL convenience wrappers (logError + logInfo + logWarn + logDebug), not just logError — removes entire abstraction layer cleanly
- Left hooks.server.ts:248 cast (inside instanceof Error guard, iterating getOwnPropertyNames) — this is the safe standard pattern
- Left gsm-evil-stop-helpers.ts type guard internal cast (Record<string, unknown> inside the guard body) — correct TypeScript pattern
- Used ExecFileException from child_process for sweep-coordinator classifyHackrfError — eliminates Error & { code?: number } cast
- Fixed gsm-evil/activity/+server.ts extractPacketsFromError with typeof narrowing instead of cast
- Pure math functions (haversine, MAC hash) moved to $lib/utils/ for client+server sharing (decided in Phase 13)
  </decisions_made>

<blockers>
None. All phases are unblocked.
</blockers>

<context>
The spec-016 feature branch is a large codebase expressiveness improvement with 86 tasks across 18 phases.
Phases 1-14 (Part A code patterns + Part C operational hardening) are complete.
Remaining work is Part B (client libraries), file decomposition, type safety, and route migration.
Phase 8 (client libraries) and Phase 18 (route migration) are the largest remaining efforts.
Phase 15 (decomposition) is highly parallelizable — all 13 tasks touch independent files.
Memory is constrained on RPi 5 — never run concurrent svelte-check or full test suite with Antigravity.
</context>

<next_action>
Resume with: `/speckit.implement continue` — pick up at Phase 15 (or 8/16/18 based on priority).

Recommended order per tasks.md dependency graph:

1. Phase 15 (decomposition) — unblocked, highly parallel, pure refactoring
2. Phase 16 (type safety) — unblocked, independent
3. Phase 8 (client libs) — requires npm install approvals
4. Phase 18 (route migration) — large but mechanical
5. Phase 17 (verification) — must be last
   </next_action>
